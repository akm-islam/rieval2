{"ast":null,"code":"import _toConsumableArray from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import*as d3 from'd3';import*as _ from\"lodash\";import\"./CreateNumChart.css\";var CreateNumChart=function CreateNumChart(data,feature,scatterplot_data,props){var rScale=d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6,1]);var feature_contribute=feature+\"_contribution\";var scatterplot_data=scatterplot_data.map(function(data_arr){var temp=data_arr[1].filter(function(item){return item['deviation']<props.threshold&&parseFloat(item[feature_contribute])>0;});return[data_arr[0],temp];});// set the dimensions and margins of the graph\nvar margin={top:0,right:30,bottom:70,left:40,space_for_hist:0},feature_width=520-margin.left-margin.right,height=250-margin.top-margin.bottom;//-------------------------------------------------------------All svgs\nvar parent_svg=d3.select(\"#\"+props.myid).attr(\"width\",feature_width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom+margin.space_for_hist),svg1=parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\",margin.space_for_hist).attr(\"class\",\"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\",\"myg\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var svg1=parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\",\"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\",\"myg\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");svg1.selectAll(\".myline2\").data([0]).join('line').attr(\"class\",\"myline2\").attr(\"x1\",0).attr(\"y1\",0).attr(\"x2\",0).attr(\"y2\",height).attr(\"stroke\",\"#EBEBEB\");svg1.selectAll(\".myline3\").data([0]).join('line').attr(\"class\",\"myline3\").attr(\"x1\",0).attr(\"y1\",height).attr(\"x2\",feature_width).attr(\"y2\",height).attr(\"stroke\",\"#EBEBEB\");//------------------------------------------------------------------------------------------------------ Draw Circles ends\nsvg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\",function(d){return d[0]+\"scatterplot_g_id\";}).attr(\"class\",\"scatterplot_g\").attr(\"ax\",function(d){var data_for_x_axis=d[1].map(function(item){return parseFloat(item[feature_contribute]);});var data_for_y_axis=d[1].map(function(item){return parseFloat(item[feature]);});var xScale=d3.scaleLinear().domain(d3.extent(data_for_x_axis)).range([8,feature_width-8]).nice();// This scaling is for individual model\nvar yScale=d3.scaleLinear().domain(d3.extent(data_for_y_axis)).range([height,4]).nice();// This scaling is for individual model\n//------------- Y axis\nconsole.log(data_for_y_axis,\"data_for_y_axis\");svg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\",\"myYaxis\").attr(\"transform\",\"translate(\"+0+\",\"+margin.top+\")\").call(d3.axisLeft(yScale).ticks(5).tickSize(-feature_width).tickFormat(function(d){return d%1!==0?d3.format(\".2f\")(d):d3.format(\".2s\")(d);})).select(\".domain\").remove();svg1.selectAll(\".tick line\").attr(\"stroke\",\"#EBEBEB\");d3.select(this).selectAll('circle').data(d[1]).join(\"circle\").attr(\"cx\",function(d,i){return xScale(d[feature_contribute]);}).attr(\"cy\",function(d,i){if(yScale(parseFloat(d[feature]))<10){return 10;}else if(yScale(parseFloat(d[feature]))>height-10){return height-10;}return yScale(parseFloat(d[feature]))-0;}).attr(\"actual_Y_value\",function(d){return d[feature]+\" : x value : \"+d[feature_contribute];})//.attr(\"r\", 4)\n.attr(\"r\",function(d){return parseFloat(d[feature_contribute])<=0?0:rScale(d['deviation']);}).attr(\"fill\",function(d){return props.diverginColor(d['two_realRank']).replace(\")\",\",.6)\");}).attr('class',function(d){return'my_circles';}).attr(\"id\",function(d){return d['id'];}).on('click',function(d){props.Set_clicked_circles(props.clicked_circles.includes(d['id'])?props.clicked_circles.filter(function(item){return item!=d['id'];}):[].concat(_toConsumableArray(props.clicked_circles),[d['id']]));});});//--------------------------------------------------------------------------------------------------\nsvg1.selectAll(\".my_temp_rect\").data([0]).join('rect').attr(\"class\",\"my_temp_rect\").attr(\"width\",\"100%\").attr(\"height\",100).style(\"fill\",\"white\").attr(\"y\",height);svg1.selectAll(\".myXaxis\").raise();svg1.selectAll(\".my_line\").raise();svg1.selectAll(\".scatterplot_g\").raise();//---------------------------------------------Feature Importance with Arrow\nvar ft_svg_height=25;parent_svg.selectAll(\".ft_svg\").remove();var ft_svg=parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\",40).attr(\"y\",height+10).attr(\"class\",\"ft_svg\").attr(\"width\",feature_width).attr(\"height\",ft_svg_height);var markerBoxWidth=8,markerBoxHeight=8,refX=markerBoxWidth/2,refY=markerBoxHeight/2;ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id','arrow').attr('viewBox',[0,0,markerBoxWidth,markerBoxHeight]).attr('refX',refX).attr('refY',refY).attr('markerWidth',markerBoxWidth).attr('markerHeight',markerBoxHeight).attr('orient','auto-start-reverse').append('path').attr('id','path1').attr('d',d3.line()([[0,0],[0,7],[7,3.8]])).attr('stroke','#777777').attr(\"fill\",\"#777777\");//------------------------------------------------[[x2, y2], [x1, y1]]\nft_svg.append('path').attr('d',d3.line()([[feature_width/2-65,15],[50,15]])).attr('stroke','#777777').attr('marker-end','url(#arrow)').attr('fill','none');ft_svg.append('path').attr('d',d3.line()([[feature_width-50,15],[65+feature_width/2,15]])).attr('stroke','#777777').attr('marker-start','url(#arrow)').attr('fill','none');ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\",30).attr(\"class\",\"myText_low\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('Low').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\",feature_width/2).attr(\"class\",\"myText\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('Attribute Importance').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\",feature_width-30).attr(\"class\",\"myText_high\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('High').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");//---------------------------------------------Feature Importance with Arrow\nsvg1.selectAll(\".myText2\").data([0]).join(\"text\").attr(\"class\",\"myText2\").attr('dominant-baseline',\"middle\").attr('text-anchor',\"middle\").text('attribute value').attr(\"fill\",\"#5b5959\").attr(\"font-size\",13).attr('transform',function(d){return\"rotate(-90,\"+0+\",\"+height/2+\")\";}).attr(\"x\",0).attr(\"y\",margin.left+20);//---------------------------\n};export default CreateNumChart;","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Charts/Popover/CreateNumChart.js"],"names":["d3","_","CreateNumChart","data","feature","scatterplot_data","props","rScale","scalePow","exponent","domain","extent","deviation_array","range","feature_contribute","map","data_arr","temp","filter","item","threshold","parseFloat","margin","top","right","bottom","left","space_for_hist","feature_width","height","parent_svg","select","myid","attr","svg1","selectAll","join","d","data_for_x_axis","data_for_y_axis","xScale","scaleLinear","nice","yScale","console","log","call","axisLeft","ticks","tickSize","tickFormat","format","remove","i","diverginColor","replace","on","Set_clicked_circles","clicked_circles","includes","style","raise","ft_svg_height","ft_svg","Math","random","markerBoxWidth","markerBoxHeight","refX","refY","append","line","text"],"mappings":"4JAAA,MAAO,GAAKA,CAAAA,EAAZ,KAAoB,IAApB,CACA,MAAO,GAAKC,CAAAA,CAAZ,KAAmB,QAAnB,CACA,MAAO,sBAAP,CACA,GAAIC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,IAAD,CAAOC,OAAP,CAAgBC,gBAAhB,CAAkCC,KAAlC,CAA4C,CAC/D,GAAIC,CAAAA,MAAM,CAAGP,EAAE,CAACQ,QAAH,GAAcC,QAAd,CAAuB,GAAvB,EAA4BC,MAA5B,CAAmCV,EAAE,CAACW,MAAH,CAAUL,KAAK,CAACM,eAAhB,CAAnC,EAAqEC,KAArE,CAA2E,CAAC,CAAD,CAAI,CAAJ,CAA3E,CAAb,CACA,GAAIC,CAAAA,kBAAkB,CAAGV,OAAO,CAAG,eAAnC,CACA,GAAIC,CAAAA,gBAAgB,CAAGA,gBAAgB,CAACU,GAAjB,CAAqB,SAAAC,QAAQ,CAAI,CACtD,GAAIC,CAAAA,IAAI,CAAGD,QAAQ,CAAC,CAAD,CAAR,CAAYE,MAAZ,CAAmB,SAAAC,IAAI,QAAIA,CAAAA,IAAI,CAAC,WAAD,CAAJ,CAAoBb,KAAK,CAACc,SAA1B,EAAuCC,UAAU,CAACF,IAAI,CAACL,kBAAD,CAAL,CAAV,CAAuC,CAAlF,EAAvB,CAAX,CACA,MAAO,CAACE,QAAQ,CAAC,CAAD,CAAT,CAAcC,IAAd,CAAP,CACD,CAHsB,CAAvB,CAIA;AACA,GAAIK,CAAAA,MAAM,CAAG,CAAEC,GAAG,CAAE,CAAP,CAAUC,KAAK,CAAE,EAAjB,CAAqBC,MAAM,CAAE,EAA7B,CAAiCC,IAAI,CAAE,EAAvC,CAA2CC,cAAc,CAAE,CAA3D,CAAb,CACEC,aAAa,CAAG,IAAMN,MAAM,CAACI,IAAb,CAAoBJ,MAAM,CAACE,KAD7C,CAEEK,MAAM,CAAG,IAAMP,MAAM,CAACC,GAAb,CAAmBD,MAAM,CAACG,MAFrC,CAIA;AACA,GAAIK,CAAAA,UAAU,CAAG9B,EAAE,CAAC+B,MAAH,CAAU,IAAMzB,KAAK,CAAC0B,IAAtB,EAA4BC,IAA5B,CAAiC,OAAjC,CAA0CL,aAAa,CAAGN,MAAM,CAACI,IAAvB,CAA8BJ,MAAM,CAACE,KAA/E,EAAsFS,IAAtF,CAA2F,QAA3F,CAAqGJ,MAAM,CAAGP,MAAM,CAACC,GAAhB,CAAsBD,MAAM,CAACG,MAA7B,CAAsCH,MAAM,CAACK,cAAlJ,CAAjB,CACEO,IAAI,CAAGJ,UAAU,CAACK,SAAX,CAAqB,QAArB,EAA+BhC,IAA/B,CAAoC,CAAC,CAAD,CAApC,EAAyCiC,IAAzC,CAA8C,KAA9C,EAAqDH,IAArD,CAA0D,GAA1D,CAA+DX,MAAM,CAACK,cAAtE,EAAsFM,IAAtF,CAA2F,OAA3F,CAAoG,OAApG,EAA6GE,SAA7G,CAAuH,MAAvH,EAA+HhC,IAA/H,CAAoI,CAAC,CAAD,CAApI,EAAyIiC,IAAzI,CAA8I,GAA9I,EAAmJH,IAAnJ,CAAwJ,OAAxJ,CAAiK,KAAjK,EAAwKA,IAAxK,CAA6K,WAA7K,CAA0L,aAAeX,MAAM,CAACI,IAAtB,CAA6B,GAA7B,CAAmCJ,MAAM,CAACC,GAA1C,CAAgD,GAA1O,CADT,CAIA,GAAIW,CAAAA,IAAI,CAAGJ,UAAU,CAACK,SAAX,CAAqB,QAArB,EAA+BhC,IAA/B,CAAoC,CAAC,CAAD,CAApC,EAAyCiC,IAAzC,CAA8C,KAA9C,EAAqDH,IAArD,CAA0D,OAA1D,CAAmE,OAAnE,EAA4EE,SAA5E,CAAsF,MAAtF,EAA8FhC,IAA9F,CAAmG,CAAC,CAAD,CAAnG,EAAwGiC,IAAxG,CAA6G,GAA7G,EAAkHH,IAAlH,CAAuH,OAAvH,CAAgI,KAAhI,EAAuIA,IAAvI,CAA4I,WAA5I,CACT,aAAeX,MAAM,CAACI,IAAtB,CAA6B,GAA7B,CAAmCJ,MAAM,CAACC,GAA1C,CAAgD,GADvC,CAAX,CAEAW,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2BhC,IAA3B,CAAgC,CAAC,CAAD,CAAhC,EAAqCiC,IAArC,CAA0C,MAA1C,EAAkDH,IAAlD,CAAuD,OAAvD,CAAgE,SAAhE,EAA2EA,IAA3E,CAAgF,IAAhF,CAAsF,CAAtF,EAAyFA,IAAzF,CAA8F,IAA9F,CAAoG,CAApG,EAAuGA,IAAvG,CAA4G,IAA5G,CAAkH,CAAlH,EAAqHA,IAArH,CAA0H,IAA1H,CAAgIJ,MAAhI,EAAwII,IAAxI,CAA6I,QAA7I,CAAuJ,SAAvJ,EACAC,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2BhC,IAA3B,CAAgC,CAAC,CAAD,CAAhC,EAAqCiC,IAArC,CAA0C,MAA1C,EAAkDH,IAAlD,CAAuD,OAAvD,CAAgE,SAAhE,EAA2EA,IAA3E,CAAgF,IAAhF,CAAsF,CAAtF,EAAyFA,IAAzF,CAA8F,IAA9F,CAAoGJ,MAApG,EAA4GI,IAA5G,CAAiH,IAAjH,CAAuHL,aAAvH,EAAsIK,IAAtI,CAA2I,IAA3I,CAAiJJ,MAAjJ,EAAyJI,IAAzJ,CAA8J,QAA9J,CAAwK,SAAxK,EAEA;AAEAC,IAAI,CAACC,SAAL,CAAe,gBAAf,EAAiChC,IAAjC,CAAsCE,gBAAtC,EAAwD+B,IAAxD,CAA6D,GAA7D,EAAkEH,IAAlE,CAAuE,IAAvE,CAA6E,SAAAI,CAAC,QAAIA,CAAAA,CAAC,CAAC,CAAD,CAAD,CAAO,kBAAX,EAA9E,EAA6GJ,IAA7G,CAAkH,OAAlH,CAA2H,eAA3H,EAA4IA,IAA5I,CAAiJ,IAAjJ,CAAuJ,SAAUI,CAAV,CAAa,CAClK,GAAIC,CAAAA,eAAe,CAAGD,CAAC,CAAC,CAAD,CAAD,CAAKtB,GAAL,CAAS,SAAAI,IAAI,QAAIE,CAAAA,UAAU,CAACF,IAAI,CAACL,kBAAD,CAAL,CAAd,EAAb,CAAtB,CACA,GAAIyB,CAAAA,eAAe,CAAGF,CAAC,CAAC,CAAD,CAAD,CAAKtB,GAAL,CAAS,SAAAI,IAAI,QAAIE,CAAAA,UAAU,CAACF,IAAI,CAACf,OAAD,CAAL,CAAd,EAAb,CAAtB,CAEA,GAAIoC,CAAAA,MAAM,CAAGxC,EAAE,CAACyC,WAAH,GAAiB/B,MAAjB,CAAwBV,EAAE,CAACW,MAAH,CAAU2B,eAAV,CAAxB,EAAoDzB,KAApD,CAA0D,CAAC,CAAD,CAAIe,aAAa,CAAG,CAApB,CAA1D,EAAkFc,IAAlF,EAAb,CAAsG;AACtG,GAAIC,CAAAA,MAAM,CAAG3C,EAAE,CAACyC,WAAH,GAAiB/B,MAAjB,CAAwBV,EAAE,CAACW,MAAH,CAAU4B,eAAV,CAAxB,EAAoD1B,KAApD,CAA0D,CAACgB,MAAD,CAAS,CAAT,CAA1D,EAAuEa,IAAvE,EAAb,CAA4F;AAC5F;AACAE,OAAO,CAACC,GAAR,CAAYN,eAAZ,CAA4B,iBAA5B,EAEAL,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2BhC,IAA3B,CAAgC,CAAC,CAAD,CAAhC,EAAqCiC,IAArC,CAA0C,GAA1C,EAA+CH,IAA/C,CAAoD,OAApD,CAA6D,SAA7D,EACGA,IADH,CACQ,WADR,CACqB,aAAe,CAAf,CAAmB,GAAnB,CAAyBX,MAAM,CAACC,GAAhC,CAAsC,GAD3D,EACgEuB,IADhE,CACqE9C,EAAE,CAAC+C,QAAH,CAAYJ,MAAZ,EAAoBK,KAApB,CAA0B,CAA1B,EAA6BC,QAA7B,CAAsC,CAACrB,aAAvC,EAAsDsB,UAAtD,CAAiE,SAAAb,CAAC,QAAGA,CAAAA,CAAC,CAAE,CAAH,GAAS,CAAT,CAAWrC,EAAE,CAACmD,MAAH,CAAU,KAAV,EAAiBd,CAAjB,CAAX,CAA+BrC,EAAE,CAACmD,MAAH,CAAU,KAAV,EAAiBd,CAAjB,CAAlC,EAAlE,CADrE,EAC+LN,MAD/L,CACsM,SADtM,EACiNqB,MADjN,GAEAlB,IAAI,CAACC,SAAL,CAAe,YAAf,EAA6BF,IAA7B,CAAkC,QAAlC,CAA4C,SAA5C,EAEAjC,EAAE,CAAC+B,MAAH,CAAU,IAAV,EAAgBI,SAAhB,CAA0B,QAA1B,EAAoChC,IAApC,CAAyCkC,CAAC,CAAC,CAAD,CAA1C,EACGD,IADH,CACQ,QADR,EAEGH,IAFH,CAEQ,IAFR,CAEc,SAACI,CAAD,CAAIgB,CAAJ,QAAUb,CAAAA,MAAM,CAACH,CAAC,CAACvB,kBAAD,CAAF,CAAhB,EAFd,EAGGmB,IAHH,CAGQ,IAHR,CAGc,SAACI,CAAD,CAAIgB,CAAJ,CAAU,CACpB,GAAIV,MAAM,CAACtB,UAAU,CAACgB,CAAC,CAACjC,OAAD,CAAF,CAAX,CAAN,CAAiC,EAArC,CAAyC,CACvC,MAAO,GAAP,CACD,CAFD,IAGK,IAAIuC,MAAM,CAACtB,UAAU,CAACgB,CAAC,CAACjC,OAAD,CAAF,CAAX,CAAN,CAAkCyB,MAAM,CAAG,EAA/C,CAAoD,CACvD,MAAOA,CAAAA,MAAM,CAAG,EAAhB,CACD,CACD,MAAOc,CAAAA,MAAM,CAACtB,UAAU,CAACgB,CAAC,CAACjC,OAAD,CAAF,CAAX,CAAN,CAAiC,CAAxC,CAED,CAZH,EAaG6B,IAbH,CAaQ,gBAbR,CAa0B,SAAAI,CAAC,QAAIA,CAAAA,CAAC,CAACjC,OAAD,CAAD,CAAa,eAAb,CAA+BiC,CAAC,CAACvB,kBAAD,CAApC,EAb3B,CAcE;AAdF,CAeGmB,IAfH,CAeQ,GAfR,CAea,SAAAI,CAAC,QAAIhB,CAAAA,UAAU,CAACgB,CAAC,CAACvB,kBAAD,CAAF,CAAV,EAAqC,CAArC,CAAyC,CAAzC,CAA6CP,MAAM,CAAC8B,CAAC,CAAC,WAAD,CAAF,CAAvD,EAfd,EAgBGJ,IAhBH,CAgBQ,MAhBR,CAgBgB,SAACI,CAAD,CAAO,CACnB,MAAO/B,CAAAA,KAAK,CAACgD,aAAN,CAAoBjB,CAAC,CAAC,cAAD,CAArB,EAAuCkB,OAAvC,CAA+C,GAA/C,CAAoD,MAApD,CAAP,CACD,CAlBH,EAoBGtB,IApBH,CAoBQ,OApBR,CAoBiB,SAAAI,CAAC,QAAI,YAAJ,EApBlB,EAqBGJ,IArBH,CAqBQ,IArBR,CAqBc,SAAAI,CAAC,QAAIA,CAAAA,CAAC,CAAC,IAAD,CAAL,EArBf,EAsBGmB,EAtBH,CAsBM,OAtBN,CAsBe,SAAAnB,CAAC,CAAI,CAChB/B,KAAK,CAACmD,mBAAN,CAA0BnD,KAAK,CAACoD,eAAN,CAAsBC,QAAtB,CAA+BtB,CAAC,CAAC,IAAD,CAAhC,EAA0C/B,KAAK,CAACoD,eAAN,CAAsBxC,MAAtB,CAA6B,SAAAC,IAAI,QAAIA,CAAAA,IAAI,EAAIkB,CAAC,CAAC,IAAD,CAAb,EAAjC,CAA1C,8BAAsG/B,KAAK,CAACoD,eAA5G,GAA6HrB,CAAC,CAAC,IAAD,CAA9H,EAA1B,EACD,CAxBH,EAyBD,CAtCD,EAwCA;AACAH,IAAI,CAACC,SAAL,CAAe,eAAf,EAAgChC,IAAhC,CAAqC,CAAC,CAAD,CAArC,EAA0CiC,IAA1C,CAA+C,MAA/C,EAAuDH,IAAvD,CAA4D,OAA5D,CAAqE,cAArE,EAAqFA,IAArF,CAA0F,OAA1F,CAAmG,MAAnG,EAA2GA,IAA3G,CAAgH,QAAhH,CAA0H,GAA1H,EAA+H2B,KAA/H,CAAqI,MAArI,CAA6I,OAA7I,EAAsJ3B,IAAtJ,CAA2J,GAA3J,CAAgKJ,MAAhK,EACAK,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2B0B,KAA3B,GAEA3B,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2B0B,KAA3B,GACA3B,IAAI,CAACC,SAAL,CAAe,gBAAf,EAAiC0B,KAAjC,GAEA;AACA,GAAIC,CAAAA,aAAa,CAAG,EAApB,CACAhC,UAAU,CAACK,SAAX,CAAqB,SAArB,EAAgCiB,MAAhC,GACA,GAAIW,CAAAA,MAAM,CAAGjC,UAAU,CAACK,SAAX,CAAqB,SAArB,EAAgChC,IAAhC,CAAqC,CAAC6D,IAAI,CAACC,MAAL,EAAD,CAArC,EAAsD7B,IAAtD,CAA2D,KAA3D,EAAkEH,IAAlE,CAAuE,GAAvE,CAA4E,EAA5E,EAAgFA,IAAhF,CAAqF,GAArF,CAA0FJ,MAAM,CAAC,EAAjG,EAAqGI,IAArG,CAA0G,OAA1G,CAAmH,QAAnH,EAA6HA,IAA7H,CAAkI,OAAlI,CAA2IL,aAA3I,EAA0JK,IAA1J,CAA+J,QAA/J,CAAyK6B,aAAzK,CAAb,CACA,GAAII,CAAAA,cAAc,CAAG,CAArB,CAAwBC,eAAe,CAAG,CAA1C,CAA6CC,IAAI,CAAGF,cAAc,CAAG,CAArE,CAAwEG,IAAI,CAAGF,eAAe,CAAG,CAAjG,CAEAJ,MAAM,CAAC5B,SAAP,CAAiB,MAAjB,EAAyBhC,IAAzB,CAA8B,CAAC,CAAD,CAA9B,EAAmCiC,IAAnC,CAAwC,MAAxC,EAAgDD,SAAhD,CAA0D,QAA1D,EAAoEhC,IAApE,CAAyE,CAAC,CAAD,CAAzE,EAA8EiC,IAA9E,CAAmF,QAAnF,EAA6FH,IAA7F,CAAkG,IAAlG,CAAwG,OAAxG,EAAiHA,IAAjH,CAAsH,SAAtH,CAAiI,CAAC,CAAD,CAAI,CAAJ,CAAOiC,cAAP,CAAuBC,eAAvB,CAAjI,EACGlC,IADH,CACQ,MADR,CACgBmC,IADhB,EACsBnC,IADtB,CAC2B,MAD3B,CACmCoC,IADnC,EACyCpC,IADzC,CAC8C,aAD9C,CAC6DiC,cAD7D,EAC6EjC,IAD7E,CACkF,cADlF,CACkGkC,eADlG,EACmHlC,IADnH,CACwH,QADxH,CACkI,oBADlI,EAEGqC,MAFH,CAEU,MAFV,EAEkBrC,IAFlB,CAEuB,IAFvB,CAE4B,OAF5B,EAEqCA,IAFrC,CAE0C,GAF1C,CAE+CjC,EAAE,CAACuE,IAAH,GAAU,CAAC,CAAC,CAAD,CAAI,CAAJ,CAAD,CAAS,CAAC,CAAD,CAAI,CAAJ,CAAT,CAAiB,CAAC,CAAD,CAAI,GAAJ,CAAjB,CAAV,CAF/C,EAEsFtC,IAFtF,CAE2F,QAF3F,CAEqG,SAFrG,EAEgHA,IAFhH,CAEqH,MAFrH,CAE4H,SAF5H,EAGA;AACA8B,MAAM,CAACO,MAAP,CAAc,MAAd,EAAsBrC,IAAtB,CAA2B,GAA3B,CAAgCjC,EAAE,CAACuE,IAAH,GAAU,CAAC,CAAC3C,aAAa,CAAG,CAAhB,CAAoB,EAArB,CAAyB,EAAzB,CAAD,CAA+B,CAAC,EAAD,CAAK,EAAL,CAA/B,CAAV,CAAhC,EAAqFK,IAArF,CAA0F,QAA1F,CAAoG,SAApG,EAA+GA,IAA/G,CAAoH,YAApH,CAAkI,aAAlI,EAAiJA,IAAjJ,CAAsJ,MAAtJ,CAA8J,MAA9J,EACA8B,MAAM,CAACO,MAAP,CAAc,MAAd,EAAsBrC,IAAtB,CAA2B,GAA3B,CAAgCjC,EAAE,CAACuE,IAAH,GAAU,CAAC,CAAC3C,aAAa,CAAG,EAAjB,CAAqB,EAArB,CAAD,CAA2B,CAAC,GAAKA,aAAa,CAAG,CAAtB,CAAyB,EAAzB,CAA3B,CAAV,CAAhC,EAAqGK,IAArG,CAA0G,QAA1G,CAAoH,SAApH,EAA+HA,IAA/H,CAAoI,cAApI,CAAoJ,aAApJ,EAAmKA,IAAnK,CAAwK,MAAxK,CAAgL,MAAhL,EAEA8B,MAAM,CAAC5B,SAAP,CAAiB,aAAjB,EAAgChC,IAAhC,CAAqC,CAAC,CAAD,CAArC,EAA0CiC,IAA1C,CAA+C,MAA/C,EAAuDH,IAAvD,CAA4D,GAA5D,CAAiE,EAAjE,EAAqEA,IAArE,CAA0E,OAA1E,CAAmF,YAAnF,EAAiGA,IAAjG,CAAsG,mBAAtG,CAA2H,QAA3H,EAAqIA,IAArI,CAA0I,GAA1I,CAA+I,EAA/I,EAAmJuC,IAAnJ,CAAwJ,KAAxJ,EAA+JvC,IAA/J,CAAoK,aAApK,CAAmL,QAAnL,EAA6LA,IAA7L,CAAkM,WAAlM,CAA+M,EAA/M,EAAmNA,IAAnN,CAAwN,MAAxN,CAAgO,SAAhO,EACA8B,MAAM,CAAC5B,SAAP,CAAiB,SAAjB,EAA4BhC,IAA5B,CAAiC,CAAC,CAAD,CAAjC,EAAsCiC,IAAtC,CAA2C,MAA3C,EAAmDH,IAAnD,CAAwD,GAAxD,CAA6DL,aAAa,CAAG,CAA7E,EAAgFK,IAAhF,CAAqF,OAArF,CAA8F,QAA9F,EAAwGA,IAAxG,CAA6G,mBAA7G,CAAkI,QAAlI,EAA4IA,IAA5I,CAAiJ,GAAjJ,CAAsJ,EAAtJ,EAA0JuC,IAA1J,CAA+J,sBAA/J,EAAuLvC,IAAvL,CAA4L,aAA5L,CAA2M,QAA3M,EAAqNA,IAArN,CAA0N,WAA1N,CAAuO,EAAvO,EAA2OA,IAA3O,CAAgP,MAAhP,CAAwP,SAAxP,EACA8B,MAAM,CAAC5B,SAAP,CAAiB,cAAjB,EAAiChC,IAAjC,CAAsC,CAAC,CAAD,CAAtC,EAA2CiC,IAA3C,CAAgD,MAAhD,EAAwDH,IAAxD,CAA6D,GAA7D,CAAkEL,aAAa,CAAC,EAAhF,EAAoFK,IAApF,CAAyF,OAAzF,CAAkG,aAAlG,EAAiHA,IAAjH,CAAsH,mBAAtH,CAA2I,QAA3I,EAAqJA,IAArJ,CAA0J,GAA1J,CAA+J,EAA/J,EAAmKuC,IAAnK,CAAwK,MAAxK,EAAgLvC,IAAhL,CAAqL,aAArL,CAAoM,QAApM,EAA8MA,IAA9M,CAAmN,WAAnN,CAAgO,EAAhO,EAAoOA,IAApO,CAAyO,MAAzO,CAAiP,SAAjP,EACA;AAGAC,IAAI,CAACC,SAAL,CAAe,UAAf,EAA2BhC,IAA3B,CAAgC,CAAC,CAAD,CAAhC,EAAqCiC,IAArC,CAA0C,MAA1C,EAAkDH,IAAlD,CAAuD,OAAvD,CAAgE,SAAhE,EAA2EA,IAA3E,CAAgF,mBAAhF,CAAqG,QAArG,EAA+GA,IAA/G,CAAoH,aAApH,CAAmI,QAAnI,EAA6IuC,IAA7I,CAAkJ,iBAAlJ,EAAqKvC,IAArK,CAA0K,MAA1K,CAAkL,SAAlL,EAA6LA,IAA7L,CAAkM,WAAlM,CAA+M,EAA/M,EACGA,IADH,CACQ,WADR,CACqB,SAAAI,CAAC,QAAI,cAAgB,CAAhB,CAAoB,GAApB,CAA0BR,MAAM,CAAG,CAAnC,CAAuC,GAA3C,EADtB,EACsEI,IADtE,CAC2E,GAD3E,CACgF,CADhF,EACmFA,IADnF,CACwF,GADxF,CAC6FX,MAAM,CAACI,IAAP,CAAc,EAD3G,EAEA;AACD,CA7FD,CA8FA,cAAexB,CAAAA,cAAf","sourcesContent":["import * as d3 from 'd3';\nimport * as _ from \"lodash\";\nimport \"./CreateNumChart.css\"\nvar CreateNumChart = (data, feature, scatterplot_data, props) => {\n  var rScale = d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6, 1])\n  var feature_contribute = feature + \"_contribution\"\n  var scatterplot_data = scatterplot_data.map(data_arr => {\n    var temp = data_arr[1].filter(item => item['deviation'] < props.threshold && parseFloat(item[feature_contribute]) > 0)\n    return [data_arr[0], temp]\n  })\n  // set the dimensions and margins of the graph\n  var margin = { top: 0, right: 30, bottom: 70, left: 40, space_for_hist: 0 },\n    feature_width = 520 - margin.left - margin.right,\n    height = 250 - margin.top - margin.bottom;\n\n  //-------------------------------------------------------------All svgs\n  var parent_svg = d3.select(\"#\" + props.myid).attr(\"width\", feature_width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom + margin.space_for_hist),\n    svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\", margin.space_for_hist).attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n\n  var svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\",\n    \"translate(\" + margin.left + \",\" + margin.top + \")\")\n  svg1.selectAll(\".myline2\").data([0]).join('line').attr(\"class\", \"myline2\").attr(\"x1\", 0).attr(\"y1\", 0).attr(\"x2\", 0).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\");\n  svg1.selectAll(\".myline3\").data([0]).join('line').attr(\"class\", \"myline3\").attr(\"x1\", 0).attr(\"y1\", height).attr(\"x2\", feature_width).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\");\n\n  //------------------------------------------------------------------------------------------------------ Draw Circles ends\n\n  svg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\", d => d[0] + \"scatterplot_g_id\").attr(\"class\", \"scatterplot_g\").attr(\"ax\", function (d) {\n    var data_for_x_axis = d[1].map(item => parseFloat(item[feature_contribute]))\n    var data_for_y_axis = d[1].map(item => parseFloat(item[feature]))\n\n    var xScale = d3.scaleLinear().domain(d3.extent(data_for_x_axis)).range([8, feature_width - 8]).nice() // This scaling is for individual model\n    var yScale = d3.scaleLinear().domain(d3.extent(data_for_y_axis)).range([height, 4]).nice(); // This scaling is for individual model\n    //------------- Y axis\n    console.log(data_for_y_axis,\"data_for_y_axis\")\n\n    svg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\", \"myYaxis\")\n      .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").call(d3.axisLeft(yScale).ticks(5).tickSize(-feature_width).tickFormat(d=> d% 1 !== 0?d3.format(\".2f\")(d):d3.format(\".2s\")(d))).select(\".domain\").remove()\n    svg1.selectAll(\".tick line\").attr(\"stroke\", \"#EBEBEB\")\n\n    d3.select(this).selectAll('circle').data(d[1])\n      .join(\"circle\")\n      .attr(\"cx\", (d, i) => xScale(d[feature_contribute]))\n      .attr(\"cy\", (d, i) => {\n        if (yScale(parseFloat(d[feature])) < 10) {\n          return 10;\n        }\n        else if (yScale(parseFloat(d[feature])) > (height - 10)) {\n          return height - 10;\n        }\n        return yScale(parseFloat(d[feature])) - 0\n\n      })\n      .attr(\"actual_Y_value\", d => d[feature] + \" : x value : \" + d[feature_contribute])\n      //.attr(\"r\", 4)\n      .attr(\"r\", d => parseFloat(d[feature_contribute]) <= 0 ? 0 : rScale(d['deviation']))\n      .attr(\"fill\", (d) => {\n        return props.diverginColor(d['two_realRank']).replace(\")\", \",.6)\")\n      })\n\n      .attr('class', d => 'my_circles')\n      .attr(\"id\", d => d['id'])\n      .on('click', d => {\n        props.Set_clicked_circles(props.clicked_circles.includes(d['id']) ? props.clicked_circles.filter(item => item != d['id']) : [...props.clicked_circles, d['id']])\n      })\n  })\n\n  //--------------------------------------------------------------------------------------------------\n  svg1.selectAll(\".my_temp_rect\").data([0]).join('rect').attr(\"class\", \"my_temp_rect\").attr(\"width\", \"100%\").attr(\"height\", 100).style(\"fill\", \"white\").attr(\"y\", height)\n  svg1.selectAll(\".myXaxis\").raise()\n\n  svg1.selectAll(\".my_line\").raise()\n  svg1.selectAll(\".scatterplot_g\").raise()\n\n  //---------------------------------------------Feature Importance with Arrow\n  var ft_svg_height = 25\n  parent_svg.selectAll(\".ft_svg\").remove()\n  var ft_svg = parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\", 40).attr(\"y\", height+10).attr(\"class\", \"ft_svg\").attr(\"width\", feature_width).attr(\"height\", ft_svg_height)\n  var markerBoxWidth = 8, markerBoxHeight = 8, refX = markerBoxWidth / 2, refY = markerBoxHeight / 2\n  \n  ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id', 'arrow').attr('viewBox', [0, 0, markerBoxWidth, markerBoxHeight])\n    .attr('refX', refX).attr('refY', refY).attr('markerWidth', markerBoxWidth).attr('markerHeight', markerBoxHeight).attr('orient', 'auto-start-reverse')\n    .append('path').attr('id','path1').attr('d', d3.line()([[0, 0], [0, 7], [7, 3.8]])).attr('stroke', '#777777').attr(\"fill\",\"#777777\");\n  //------------------------------------------------[[x2, y2], [x1, y1]]\n  ft_svg.append('path').attr('d', d3.line()([[feature_width / 2 - 65, 15], [50, 15]])).attr('stroke', '#777777').attr('marker-end', 'url(#arrow)').attr('fill', 'none');\n  ft_svg.append('path').attr('d', d3.line()([[feature_width - 50, 15], [65 + feature_width / 2, 15]])).attr('stroke', '#777777').attr('marker-start', 'url(#arrow)').attr('fill', 'none');\n\n  ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\", 30).attr(\"class\", \"myText_low\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Low').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\", feature_width / 2).attr(\"class\", \"myText\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Attribute Importance').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\", feature_width-30).attr(\"class\", \"myText_high\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('High').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  //---------------------------------------------Feature Importance with Arrow\n  \n\n  svg1.selectAll(\".myText2\").data([0]).join(\"text\").attr(\"class\", \"myText2\").attr('dominant-baseline', \"middle\").attr('text-anchor', \"middle\").text('attribute value').attr(\"fill\", \"#5b5959\").attr(\"font-size\", 13)\n    .attr('transform', d => \"rotate(-90,\" + 0 + \",\" + height / 2 + \")\").attr(\"x\", 0).attr(\"y\", margin.left + 20)\n  //---------------------------\n}\nexport default CreateNumChart"]},"metadata":{},"sourceType":"module"}