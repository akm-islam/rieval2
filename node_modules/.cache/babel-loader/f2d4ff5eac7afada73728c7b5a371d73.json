{"ast":null,"code":"import * as d3 from 'd3';\nimport * as _ from \"lodash\";\nimport \"./CreateNumChart.css\";\n\nvar CreateNumChart = (data, feature, scatterplot_data, props) => {\n  var rScale = d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6, 1]);\n  var feature_contribute = feature + \"_contribution\";\n  var scatterplot_data = scatterplot_data.map(data_arr => {\n    var temp = data_arr[1].filter(item => item['deviation'] < props.threshold && parseFloat(item[feature_contribute]) > 0);\n    return [data_arr[0], temp];\n  }); // set the dimensions and margins of the graph\n\n  var margin = {\n    top: 0,\n    right: 30,\n    bottom: 70,\n    left: 40,\n    space_for_hist: 0\n  },\n      feature_width = 520 - margin.left - margin.right,\n      height = 250 - margin.top - margin.bottom; //-------------------------------------------------------------All svgs\n\n  var parent_svg = d3.select(\"#\" + props.myid).attr(\"width\", feature_width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom + margin.space_for_hist),\n      svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\", margin.space_for_hist).attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n  var svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n  svg1.selectAll(\".myline2\").data([0]).join('line').attr(\"class\", \"myline2\").attr(\"x1\", 0).attr(\"y1\", 0).attr(\"x2\", 0).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\");\n  svg1.selectAll(\".myline3\").data([0]).join('line').attr(\"class\", \"myline3\").attr(\"x1\", 0).attr(\"y1\", height).attr(\"x2\", feature_width).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\"); //------------------------------------------------------------------------------------------------------ Draw Circles ends\n\n  svg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\", d => d[0] + \"scatterplot_g_id\").attr(\"class\", \"scatterplot_g\").attr(\"ax\", function (d) {\n    var data_for_x_axis = d[1].map(item => parseFloat(item[feature_contribute]));\n    var data_for_y_axis = d[1].map(item => parseFloat(item[feature]));\n    var xScale = d3.scaleLinear().domain(d3.extent(data_for_x_axis)).range([8, feature_width - 8]).nice(); // This scaling is for individual model\n\n    var yScale = d3.scaleLinear().domain(d3.extent(data_for_y_axis)).range([height, 4]).nice(); // This scaling is for individual model\n    //------------- Y axis\n\n    console.log(data_for_y_axis, \"data_for_y_axis\");\n    svg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\", \"myYaxis\").attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").call(d3.axisLeft(yScale).ticks(5).tickSize(-feature_width).tickFormat(d => d % 1 !== 0 ? d3.format(\".2f\")(d) : d3.format(\".2s\")(d))).select(\".domain\").remove();\n    svg1.selectAll(\".tick line\").attr(\"stroke\", \"#EBEBEB\");\n    d3.select(this).selectAll('circle').data(d[1]).join(\"circle\").attr(\"cx\", (d, i) => xScale(d[feature_contribute])).attr(\"cy\", (d, i) => {\n      if (yScale(parseFloat(d[feature])) < 10) {\n        return 10;\n      } else if (yScale(parseFloat(d[feature])) > height - 10) {\n        return height - 10;\n      }\n\n      return yScale(parseFloat(d[feature])) - 0;\n    }).attr(\"actual_Y_value\", d => d[feature] + \" : x value : \" + d[feature_contribute]) //.attr(\"r\", 4)\n    .attr(\"r\", d => parseFloat(d[feature_contribute]) <= 0 ? 0 : rScale(d['deviation'])).attr(\"fill\", d => {\n      return props.diverginColor(d['two_realRank']).replace(\")\", \",.6)\");\n    }).attr('class', d => 'my_circles').attr(\"id\", d => d['id']).on('click', d => {\n      props.Set_clicked_circles(props.clicked_circles.includes(d['id']) ? props.clicked_circles.filter(item => item != d['id']) : [...props.clicked_circles, d['id']]);\n    });\n  }); //--------------------------------------------------------------------------------------------------\n\n  svg1.selectAll(\".my_temp_rect\").data([0]).join('rect').attr(\"class\", \"my_temp_rect\").attr(\"width\", \"100%\").attr(\"height\", 100).style(\"fill\", \"white\").attr(\"y\", height);\n  svg1.selectAll(\".myXaxis\").raise();\n  svg1.selectAll(\".my_line\").raise();\n  svg1.selectAll(\".scatterplot_g\").raise(); //---------------------------------------------Feature Importance with Arrow\n\n  var ft_svg_height = 25;\n  parent_svg.selectAll(\".ft_svg\").remove();\n  var ft_svg = parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\", 40).attr(\"y\", height + 10).attr(\"class\", \"ft_svg\").attr(\"width\", feature_width).attr(\"height\", ft_svg_height);\n  var markerBoxWidth = 8,\n      markerBoxHeight = 8,\n      refX = markerBoxWidth / 2,\n      refY = markerBoxHeight / 2;\n  ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id', 'arrow').attr('viewBox', [0, 0, markerBoxWidth, markerBoxHeight]).attr('refX', refX).attr('refY', refY).attr('markerWidth', markerBoxWidth).attr('markerHeight', markerBoxHeight).attr('orient', 'auto-start-reverse').append('path').attr('id', 'path1').attr('d', d3.line()([[0, 0], [0, 7], [7, 3.8]])).attr('stroke', '#777777').attr(\"fill\", \"#777777\"); //------------------------------------------------[[x2, y2], [x1, y1]]\n\n  ft_svg.append('path').attr('d', d3.line()([[feature_width / 2 - 65, 15], [50, 15]])).attr('stroke', '#777777').attr('marker-end', 'url(#arrow)').attr('fill', 'none');\n  ft_svg.append('path').attr('d', d3.line()([[feature_width - 50, 15], [65 + feature_width / 2, 15]])).attr('stroke', '#777777').attr('marker-start', 'url(#arrow)').attr('fill', 'none');\n  ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\", 30).attr(\"class\", \"myText_low\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Low').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\");\n  ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\", feature_width / 2).attr(\"class\", \"myText\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Attribute Importance').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\");\n  ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\", feature_width - 30).attr(\"class\", \"myText_high\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('High').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\"); //---------------------------------------------Feature Importance with Arrow\n\n  svg1.selectAll(\".myText2\").data([0]).join(\"text\").attr(\"class\", \"myText2\").attr('dominant-baseline', \"middle\").attr('text-anchor', \"middle\").text('attribute value').attr(\"fill\", \"#5b5959\").attr(\"font-size\", 13).attr('transform', d => \"rotate(-90,\" + 0 + \",\" + height / 2 + \")\").attr(\"x\", 0).attr(\"y\", margin.left + 20); //---------------------------\n};\n\nexport default CreateNumChart;","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Charts/Popover/CreateNumChart.js"],"names":["d3","_","CreateNumChart","data","feature","scatterplot_data","props","rScale","scalePow","exponent","domain","extent","deviation_array","range","feature_contribute","map","data_arr","temp","filter","item","threshold","parseFloat","margin","top","right","bottom","left","space_for_hist","feature_width","height","parent_svg","select","myid","attr","svg1","selectAll","join","d","data_for_x_axis","data_for_y_axis","xScale","scaleLinear","nice","yScale","console","log","call","axisLeft","ticks","tickSize","tickFormat","format","remove","i","diverginColor","replace","on","Set_clicked_circles","clicked_circles","includes","style","raise","ft_svg_height","ft_svg","Math","random","markerBoxWidth","markerBoxHeight","refX","refY","append","line","text"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\nimport * as _ from \"lodash\";\nimport \"./CreateNumChart.css\"\nvar CreateNumChart = (data, feature, scatterplot_data, props) => {\n  var rScale = d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6, 1])\n  var feature_contribute = feature + \"_contribution\"\n  var scatterplot_data = scatterplot_data.map(data_arr => {\n    var temp = data_arr[1].filter(item => item['deviation'] < props.threshold && parseFloat(item[feature_contribute]) > 0)\n    return [data_arr[0], temp]\n  })\n  // set the dimensions and margins of the graph\n  var margin = { top: 0, right: 30, bottom: 70, left: 40, space_for_hist: 0 },\n    feature_width = 520 - margin.left - margin.right,\n    height = 250 - margin.top - margin.bottom;\n\n  //-------------------------------------------------------------All svgs\n  var parent_svg = d3.select(\"#\" + props.myid).attr(\"width\", feature_width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom + margin.space_for_hist),\n    svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\", margin.space_for_hist).attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n\n  var svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\",\n    \"translate(\" + margin.left + \",\" + margin.top + \")\")\n  svg1.selectAll(\".myline2\").data([0]).join('line').attr(\"class\", \"myline2\").attr(\"x1\", 0).attr(\"y1\", 0).attr(\"x2\", 0).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\");\n  svg1.selectAll(\".myline3\").data([0]).join('line').attr(\"class\", \"myline3\").attr(\"x1\", 0).attr(\"y1\", height).attr(\"x2\", feature_width).attr(\"y2\", height).attr(\"stroke\", \"#EBEBEB\");\n\n  //------------------------------------------------------------------------------------------------------ Draw Circles ends\n\n  svg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\", d => d[0] + \"scatterplot_g_id\").attr(\"class\", \"scatterplot_g\").attr(\"ax\", function (d) {\n    var data_for_x_axis = d[1].map(item => parseFloat(item[feature_contribute]))\n    var data_for_y_axis = d[1].map(item => parseFloat(item[feature]))\n\n    var xScale = d3.scaleLinear().domain(d3.extent(data_for_x_axis)).range([8, feature_width - 8]).nice() // This scaling is for individual model\n    var yScale = d3.scaleLinear().domain(d3.extent(data_for_y_axis)).range([height, 4]).nice(); // This scaling is for individual model\n    //------------- Y axis\n    console.log(data_for_y_axis,\"data_for_y_axis\")\n\n    svg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\", \"myYaxis\")\n      .attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").call(d3.axisLeft(yScale).ticks(5).tickSize(-feature_width).tickFormat(d=> d% 1 !== 0?d3.format(\".2f\")(d):d3.format(\".2s\")(d))).select(\".domain\").remove()\n    svg1.selectAll(\".tick line\").attr(\"stroke\", \"#EBEBEB\")\n\n    d3.select(this).selectAll('circle').data(d[1])\n      .join(\"circle\")\n      .attr(\"cx\", (d, i) => xScale(d[feature_contribute]))\n      .attr(\"cy\", (d, i) => {\n        if (yScale(parseFloat(d[feature])) < 10) {\n          return 10;\n        }\n        else if (yScale(parseFloat(d[feature])) > (height - 10)) {\n          return height - 10;\n        }\n        return yScale(parseFloat(d[feature])) - 0\n\n      })\n      .attr(\"actual_Y_value\", d => d[feature] + \" : x value : \" + d[feature_contribute])\n      //.attr(\"r\", 4)\n      .attr(\"r\", d => parseFloat(d[feature_contribute]) <= 0 ? 0 : rScale(d['deviation']))\n      .attr(\"fill\", (d) => {\n        return props.diverginColor(d['two_realRank']).replace(\")\", \",.6)\")\n      })\n\n      .attr('class', d => 'my_circles')\n      .attr(\"id\", d => d['id'])\n      .on('click', d => {\n        props.Set_clicked_circles(props.clicked_circles.includes(d['id']) ? props.clicked_circles.filter(item => item != d['id']) : [...props.clicked_circles, d['id']])\n      })\n  })\n\n  //--------------------------------------------------------------------------------------------------\n  svg1.selectAll(\".my_temp_rect\").data([0]).join('rect').attr(\"class\", \"my_temp_rect\").attr(\"width\", \"100%\").attr(\"height\", 100).style(\"fill\", \"white\").attr(\"y\", height)\n  svg1.selectAll(\".myXaxis\").raise()\n\n  svg1.selectAll(\".my_line\").raise()\n  svg1.selectAll(\".scatterplot_g\").raise()\n\n  //---------------------------------------------Feature Importance with Arrow\n  var ft_svg_height = 25\n  parent_svg.selectAll(\".ft_svg\").remove()\n  var ft_svg = parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\", 40).attr(\"y\", height+10).attr(\"class\", \"ft_svg\").attr(\"width\", feature_width).attr(\"height\", ft_svg_height)\n  var markerBoxWidth = 8, markerBoxHeight = 8, refX = markerBoxWidth / 2, refY = markerBoxHeight / 2\n  \n  ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id', 'arrow').attr('viewBox', [0, 0, markerBoxWidth, markerBoxHeight])\n    .attr('refX', refX).attr('refY', refY).attr('markerWidth', markerBoxWidth).attr('markerHeight', markerBoxHeight).attr('orient', 'auto-start-reverse')\n    .append('path').attr('id','path1').attr('d', d3.line()([[0, 0], [0, 7], [7, 3.8]])).attr('stroke', '#777777').attr(\"fill\",\"#777777\");\n  //------------------------------------------------[[x2, y2], [x1, y1]]\n  ft_svg.append('path').attr('d', d3.line()([[feature_width / 2 - 65, 15], [50, 15]])).attr('stroke', '#777777').attr('marker-end', 'url(#arrow)').attr('fill', 'none');\n  ft_svg.append('path').attr('d', d3.line()([[feature_width - 50, 15], [65 + feature_width / 2, 15]])).attr('stroke', '#777777').attr('marker-start', 'url(#arrow)').attr('fill', 'none');\n\n  ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\", 30).attr(\"class\", \"myText_low\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Low').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\", feature_width / 2).attr(\"class\", \"myText\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Attribute Importance').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\", feature_width-30).attr(\"class\", \"myText_high\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('High').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  //---------------------------------------------Feature Importance with Arrow\n  \n\n  svg1.selectAll(\".myText2\").data([0]).join(\"text\").attr(\"class\", \"myText2\").attr('dominant-baseline', \"middle\").attr('text-anchor', \"middle\").text('attribute value').attr(\"fill\", \"#5b5959\").attr(\"font-size\", 13)\n    .attr('transform', d => \"rotate(-90,\" + 0 + \",\" + height / 2 + \")\").attr(\"x\", 0).attr(\"y\", margin.left + 20)\n  //---------------------------\n}\nexport default CreateNumChart"]},"metadata":{},"sourceType":"module"}