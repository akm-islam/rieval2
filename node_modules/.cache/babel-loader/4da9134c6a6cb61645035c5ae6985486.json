{"ast":null,"code":"import _defineProperty from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import*as d3 from'd3';import'./YearModeComponent.scss';import{connect}from\"react-redux\";import*as deviation_chart from\"../DevPlot/deviation_chart\";import*as misc_algo from'../../../Algorithms/misc_algo';import*as $ from'jquery';import Year1DropDown from'./Year1DropDown';import Year2DropDown from'./Year2DropDown';import YearModelSelection from\"./YearAndModelSelection/YearModelSelection\";import ExpChart from'./02ExpChartComponentTime';import Popover from'./03TimePopover';import Box from'@mui/material/Box';import Grid from'@mui/material/Grid';var SlopeChart=/*#__PURE__*/function(_Component){_inherits(SlopeChart,_Component);var _super=_createSuper(SlopeChart);function SlopeChart(props){var _this;_classCallCheck(this,SlopeChart);_this=_super.call(this,props);_this.line_color=null;_this.state={height_slope_exp_chart:700,mouseX:0,mouseY:0};return _this;}_createClass(SlopeChart,[{key:\"componentDidMount\",value:function componentDidMount(){this.setState({width:window.innerHeight});}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(prevProps,prevState){return true;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this2=this;//------------------------------\nvar selected_instances=d3.range(this.props.time_mode_range[0],this.props.time_mode_range[1]+1);var min=d3.min(selected_instances),max=d3.max(selected_instances);var d=(max-min)/8;var diverginColor=d3.scaleLinear().domain([min+d*7,min+d*6,min+d*5,min+d*4,min+d*3,min+d*2,min]).interpolate(d3.interpolateRgb).range(['#af8dc3','#b197c1','#dbd88c','#dbd88c','#dbd88c','#90bc8d','#7fbf7b']);//----------\nvar under_threshold_instances=[];var year_data=this.props.original_data.filter(function(item){return _this2.props.time_mode_year1==item['1-qid'];});year_data.map(function(item){var two_realRank=parseInt(item['two_realRank']);var predicted_rank=parseInt(item[_this2.props.time_mode_model]);if(Math.abs(predicted_rank-two_realRank)<_this2.props.threshold){under_threshold_instances.push(two_realRank);}});var selected_instances1=selected_instances.filter(function(item){return under_threshold_instances.includes(item);});deviation_chart.Create_deviation_chart('r1d','r1exp',selected_instances1,this.props.original_data,[this.props.time_mode_model],this.props.anim_config,this.props.time_mode_year1,this.props.average_m,this.props.clicked_circles,this.props.Set_clicked_circles,diverginColor,this.props.sparkline_data,this.props.Set_time_mode_year1,this.props.dataset,this.props.threshold);//------------------------------\nvar under_threshold_instances=[];var year_data=this.props.original_data.filter(function(item){return _this2.props.time_mode_year2==item['1-qid'];});year_data.map(function(item){var two_realRank=parseInt(item['two_realRank']);var predicted_rank=parseInt(item[_this2.props.time_mode_model]);if(Math.abs(predicted_rank-two_realRank)<_this2.props.threshold){under_threshold_instances.push(two_realRank);}});var selected_instances2=selected_instances.filter(function(item){return under_threshold_instances.includes(item);});deviation_chart.Create_deviation_chart('r2d','r2exp',selected_instances2,this.props.original_data,[this.props.time_mode_model],this.props.anim_config,this.props.time_mode_year2,this.props.average_m,this.props.clicked_circles,this.props.Set_clicked_circles,diverginColor,this.props.sparkline_data,this.props.Set_time_mode_year2,this.props.dataset,this.props.threshold);//------------------------------\nmisc_algo.handle_transparency(\"None\",this.props.clicked_circles,this.props.anim_config);}},{key:\"render\",value:function render(){var _this3=this;var selected_instances=d3.range(this.props.time_mode_range[0],this.props.time_mode_range[1]+1);//--------------------\nvar deviation_array=[];this.props.lime_data[this.props.time_mode_model].map(function(item){if((item['1-qid']==_this3.props.time_mode_year1||item['1-qid']==_this3.props.time_mode_year2)&&selected_instances.includes(parseInt(item['two_realRank']))){deviation_array.push(item['deviation']);}});console.log(deviation_array,\"deviation_array\");this.props.Set_deviation_array(deviation_array);//--------------------\nvar min=d3.min(selected_instances),max=d3.max(selected_instances);var d=(max-min)/8;var diverginColor=d3.scaleLinear().domain([min+d*7,min+d*6,min+d*5,min+d*4,min+d*3,min+d*2,min]).interpolate(d3.interpolateRgb).range(['#af8dc3','#b197c1','#dbd88c','#dbd88c','#dbd88c','#90bc8d','#7fbf7b']);this.props.Set_selected_instances(selected_instances);return/*#__PURE__*/React.createElement(Box,{className:\"box_root\",sx:{width:'100%',height:'100%',padding:0.5}},/*#__PURE__*/React.createElement(Grid,{container:true,justifyContent:\"space-between\"},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(\"div\",{className:\"year_and_model_selector_and_slider_container\",style:{width:'100%'}},/*#__PURE__*/React.createElement(YearModelSelection,null))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:5.9,className:\"Group1_container\",style:{borderTop:'2px solid #eaeaea',borderLeft:'2px solid #eaeaea',borderRight:'2px solid #eaeaea'}},/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,style:{padding:0}},/*#__PURE__*/React.createElement(\"div\",{className:\"slidergroup1\",style:{width:'100%',height:30}},/*#__PURE__*/React.createElement(Year1DropDown,null))),/*#__PURE__*/React.createElement(Grid,{className:\"dev_plot_and_exp_container\",item:true,xs:6},/*#__PURE__*/React.createElement(\"div\",{className:\"deviation_plot_container_div\",style:{width:'100%',height:$('.box_root').height()-($('.year_and_model_selector_and_slider_container').height()+$('.slidergroup1').height()),overflow:'scroll'}},/*#__PURE__*/React.createElement(\"svg\",{id:\"r1d\",style:{width:\"100%\"}}))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:6},this.props.rank_data!=null?/*#__PURE__*/React.createElement(\"div\",{className:\"explanation_plot_container\",style:{width:'100%',height:'100%'}},/*#__PURE__*/React.createElement(ExpChart,{exp_data:[[\"r1exp\",this.props.time_mode_year1],[\"r2exp\",this.props.time_mode_year2]],diverginColor:diverginColor,exp_id:\"r1exp\",default_models:[this.props.time_mode_model],state_range:this.props.time_mode_range,selected_year:this.props.time_mode_year1,model_name:this.props.time_mode_model})):null))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:5.9,style:{borderTop:'2px solid #eaeaea',borderLeft:'2px solid #eaeaea',borderRight:'2px solid #eaeaea'}},/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,style:{padding:0}},/*#__PURE__*/React.createElement(\"div\",{className:\"slidergroup2\",style:{width:'100%',height:30}},/*#__PURE__*/React.createElement(Year2DropDown,null))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:6},/*#__PURE__*/React.createElement(\"div\",{className:\"deviation_plot_container_div\",style:{width:'100%',height:$('.box_root').height()-($('.year_and_model_selector_and_slider_container').height()+$('.slidergroup2').height()),overflow:'scroll'}},/*#__PURE__*/React.createElement(\"svg\",{id:\"r2d\",style:{width:\"100%\"}}))),/*#__PURE__*/React.createElement(Grid,{item:true,xs:6},this.props.rank_data!=null?/*#__PURE__*/React.createElement(\"div\",{className:\"explanation_plot_container\",style:{width:'100%',height:500}},/*#__PURE__*/React.createElement(ExpChart,{exp_data:[[\"r1exp\",this.props.time_mode_year1],[\"r2exp\",this.props.time_mode_year2]],diverginColor:diverginColor,exp_id:\"r2exp\",default_models:[this.props.time_mode_model],state_range:this.props.time_mode_range,selected_year:this.props.time_mode_year2,model_name:this.props.time_mode_model})):null)))),/*#__PURE__*/React.createElement(Popover,{diverginColor:diverginColor,default_models:[this.props.time_mode_model]}));}}]);return SlopeChart;}(Component);var maptstateToprop=function maptstateToprop(state){var _ref;return _ref={time_mode_year1:state.time_mode_year1,time_mode_year2:state.time_mode_year2,mode:state.mode,time_mode_range:state.time_mode_range,time_mode_model:state.time_mode_model,default_models:state.default_models,original_data:state.original_data,dataset:state.dataset,sparkline_data:state.sparkline_data},_defineProperty(_ref,\"dataset\",state.dataset),_defineProperty(_ref,\"anim_config\",state.anim_config),_defineProperty(_ref,\"average_m\",state.average_m),_defineProperty(_ref,\"rank_data\",state.rank_data),_defineProperty(_ref,\"clicked_circles\",state.clicked_circles),_defineProperty(_ref,\"threshold\",state.threshold),_defineProperty(_ref,\"histogram_data\",state.histogram_data),_defineProperty(_ref,\"lime_data\",state.lime_data),_ref;};var mapdispatchToprop=function mapdispatchToprop(dispatch){return{Set_selected_instances:function Set_selected_instances(val){return dispatch({type:\"selected_instances\",value:val});},Set_clicked_circles:function Set_clicked_circles(val){return dispatch({type:\"clicked_circles\",value:val});},Set_time_mode_year1:function Set_time_mode_year1(val){return dispatch({type:\"time_mode_year1\",value:val});},Set_time_mode_year2:function Set_time_mode_year2(val){return dispatch({type:\"time_mode_year2\",value:val});},Set_deviation_array:function Set_deviation_array(val){return dispatch({type:\"deviation_array\",value:val});}};};export default connect(maptstateToprop,mapdispatchToprop)(SlopeChart);","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Charts/Time/01YearChartComponent.js"],"names":["React","Component","d3","connect","deviation_chart","misc_algo","$","Year1DropDown","Year2DropDown","YearModelSelection","ExpChart","Popover","Box","Grid","SlopeChart","props","line_color","state","height_slope_exp_chart","mouseX","mouseY","setState","width","window","innerHeight","prevProps","prevState","selected_instances","range","time_mode_range","min","max","d","diverginColor","scaleLinear","domain","interpolate","interpolateRgb","under_threshold_instances","year_data","original_data","filter","item","time_mode_year1","map","two_realRank","parseInt","predicted_rank","time_mode_model","Math","abs","threshold","push","selected_instances1","includes","Create_deviation_chart","anim_config","average_m","clicked_circles","Set_clicked_circles","sparkline_data","Set_time_mode_year1","dataset","time_mode_year2","selected_instances2","Set_time_mode_year2","handle_transparency","deviation_array","lime_data","console","log","Set_deviation_array","Set_selected_instances","height","padding","borderTop","borderLeft","borderRight","overflow","rank_data","maptstateToprop","mode","default_models","histogram_data","mapdispatchToprop","dispatch","val","type","value"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport * as d3 from 'd3';\nimport './YearModeComponent.scss';\nimport { connect } from \"react-redux\";\nimport * as deviation_chart from \"../DevPlot/deviation_chart\"\nimport * as misc_algo from '../../../Algorithms/misc_algo'\nimport * as $ from 'jquery';\nimport Year1DropDown from './Year1DropDown';\nimport Year2DropDown from './Year2DropDown';\nimport YearModelSelection from \"./YearAndModelSelection/YearModelSelection\"\nimport ExpChart from './02ExpChartComponentTime';\nimport Popover from './03TimePopover';\nimport Box from '@mui/material/Box';\nimport Grid from '@mui/material/Grid';\n\nclass SlopeChart extends Component {\n  constructor(props) {\n    super(props);\n    this.line_color = null;\n    this.state = { height_slope_exp_chart: 700, mouseX: 0, mouseY: 0 }\n  }\n  componentDidMount() {\n    this.setState({ width: window.innerHeight })\n  }\n  shouldComponentUpdate(prevProps, prevState) {\n    return true;\n  }\n  componentDidUpdate(prevProps, prevState) {\n    //------------------------------\n    var selected_instances = d3.range(this.props.time_mode_range[0], this.props.time_mode_range[1] + 1)\n    var min = d3.min(selected_instances), max = d3.max(selected_instances);\n    var d = (max - min) / 8;\n    var diverginColor = d3.scaleLinear().domain([min + d * 7, min + d * 6, min + d * 5, min + d * 4, min + d * 3, min + d * 2, min]).interpolate(d3.interpolateRgb).range(['#af8dc3', '#b197c1', '#dbd88c', '#dbd88c', '#dbd88c', '#90bc8d', '#7fbf7b']);\n\n    //----------\n    var under_threshold_instances = []\n    var year_data = this.props.original_data.filter(item => this.props.time_mode_year1 == item['1-qid'])\n    year_data.map(item => {\n      var two_realRank = parseInt(item['two_realRank'])\n      var predicted_rank = parseInt(item[this.props.time_mode_model])\n      if (Math.abs(predicted_rank - two_realRank) < this.props.threshold) {\n        under_threshold_instances.push(two_realRank)\n      }\n    })\n    var selected_instances1 = selected_instances.filter(item => under_threshold_instances.includes(item))\n    deviation_chart.Create_deviation_chart('r1d', 'r1exp', selected_instances1, this.props.original_data, [this.props.time_mode_model], this.props.anim_config, this.props.time_mode_year1, this.props.average_m, this.props.clicked_circles, this.props.Set_clicked_circles, diverginColor, this.props.sparkline_data, this.props.Set_time_mode_year1, this.props.dataset, this.props.threshold)\n    //------------------------------\n    var under_threshold_instances = []\n    var year_data = this.props.original_data.filter(item => this.props.time_mode_year2 == item['1-qid'])\n    year_data.map(item => {\n      var two_realRank = parseInt(item['two_realRank'])\n      var predicted_rank = parseInt(item[this.props.time_mode_model])\n      if (Math.abs(predicted_rank - two_realRank) < this.props.threshold) {\n        under_threshold_instances.push(two_realRank)\n      }\n    })\n    var selected_instances2 = selected_instances.filter(item => under_threshold_instances.includes(item))\n\n    deviation_chart.Create_deviation_chart('r2d', 'r2exp', selected_instances2, this.props.original_data, [this.props.time_mode_model], this.props.anim_config, this.props.time_mode_year2, this.props.average_m, this.props.clicked_circles, this.props.Set_clicked_circles, diverginColor, this.props.sparkline_data, this.props.Set_time_mode_year2, this.props.dataset, this.props.threshold)\n    //------------------------------\n    misc_algo.handle_transparency(\"None\", this.props.clicked_circles, this.props.anim_config)\n\n  }\n  render() {\n    var selected_instances = d3.range(this.props.time_mode_range[0], this.props.time_mode_range[1] + 1)\n    //--------------------\n    var deviation_array = []\n    this.props.lime_data[this.props.time_mode_model].map(item => {\n      if ((item['1-qid'] == this.props.time_mode_year1 || item['1-qid'] == this.props.time_mode_year2) && selected_instances.includes(parseInt(item['two_realRank']))) {\n        deviation_array.push(item['deviation'])\n      }\n    })\n    console.log(deviation_array,\"deviation_array\")\n    this.props.Set_deviation_array(deviation_array)\n    //--------------------\n    var min = d3.min(selected_instances), max = d3.max(selected_instances);\n    var d = (max - min) / 8;\n    var diverginColor = d3.scaleLinear().domain([min + d * 7, min + d * 6, min + d * 5, min + d * 4, min + d * 3, min + d * 2, min]).interpolate(d3.interpolateRgb).range(['#af8dc3', '#b197c1', '#dbd88c', '#dbd88c', '#dbd88c', '#90bc8d', '#7fbf7b']);\n    this.props.Set_selected_instances(selected_instances)\n    return (\n      <Box className=\"box_root\" sx={{ width: '100%', height: '100%', padding: 0.5 }}>\n        <Grid container justifyContent=\"space-between\">\n          <Grid item xs={12}>\n            <div className=\"year_and_model_selector_and_slider_container\" style={{ width: '100%' }}><YearModelSelection></YearModelSelection></div>\n          </Grid>\n          {/* Group 1 */}\n          <Grid item xs={5.9} className=\"Group1_container\" style={{ borderTop: '2px solid #eaeaea', borderLeft: '2px solid #eaeaea', borderRight: '2px solid #eaeaea' }}>\n            <Grid container>\n              <Grid item xs={12} style={{ padding: 0 }}>\n                <div className=\"slidergroup1\" style={{ width: '100%', height: 30 }}><Year1DropDown></Year1DropDown></div>\n              </Grid>\n              <Grid className=\"dev_plot_and_exp_container\" item xs={6}>\n                <div className=\"deviation_plot_container_div\" style={{ width: '100%', height: $('.box_root').height() - ($('.year_and_model_selector_and_slider_container').height() + $('.slidergroup1').height()), overflow: 'scroll' }}><svg id=\"r1d\" style={{ width: \"100%\" }}></svg></div>\n              </Grid>\n              <Grid item xs={6}>\n                {\n                  this.props.rank_data != null ? <div className=\"explanation_plot_container\" style={{ width: '100%', height: '100%', }}>\n                    <ExpChart exp_data={[[\"r1exp\", this.props.time_mode_year1], [\"r2exp\", this.props.time_mode_year2]]} diverginColor={diverginColor} exp_id=\"r1exp\" default_models={[this.props.time_mode_model]} state_range={this.props.time_mode_range} selected_year={this.props.time_mode_year1} model_name={this.props.time_mode_model}></ExpChart>\n                  </div> : null\n                }\n              </Grid>\n            </Grid>\n          </Grid>\n          {/* Group 2 */}\n          <Grid item xs={5.9} style={{ borderTop: '2px solid #eaeaea', borderLeft: '2px solid #eaeaea', borderRight: '2px solid #eaeaea' }}>\n            <Grid container>\n              <Grid item xs={12} style={{ padding: 0 }}>\n                <div className=\"slidergroup2\" style={{ width: '100%', height: 30 }}><Year2DropDown></Year2DropDown></div>\n              </Grid>\n              <Grid item xs={6}>\n                <div className=\"deviation_plot_container_div\" style={{ width: '100%', height: $('.box_root').height() - ($('.year_and_model_selector_and_slider_container').height() + $('.slidergroup2').height()), overflow: 'scroll' }}><svg id=\"r2d\" style={{ width: \"100%\" }}></svg></div>\n              </Grid>\n              <Grid item xs={6}>\n                {\n                  this.props.rank_data != null ? <div className=\"explanation_plot_container\" style={{ width: '100%', height: 500, }}>\n                    <ExpChart exp_data={[[\"r1exp\", this.props.time_mode_year1], [\"r2exp\", this.props.time_mode_year2]]} diverginColor={diverginColor} exp_id=\"r2exp\" default_models={[this.props.time_mode_model]} state_range={this.props.time_mode_range} selected_year={this.props.time_mode_year2} model_name={this.props.time_mode_model}></ExpChart>\n                  </div> : null\n                }\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n        <Popover diverginColor={diverginColor} default_models={[this.props.time_mode_model]}></Popover>\n      </Box>\n    )\n  }\n}\nconst maptstateToprop = (state) => {\n  return {\n    time_mode_year1: state.time_mode_year1,\n    time_mode_year2: state.time_mode_year2,\n    mode: state.mode,\n    time_mode_range: state.time_mode_range,\n    time_mode_model: state.time_mode_model,\n    default_models: state.default_models,\n    original_data: state.original_data,\n    dataset: state.dataset,\n    sparkline_data: state.sparkline_data,\n    dataset: state.dataset,\n    anim_config: state.anim_config,\n    average_m: state.average_m,\n    rank_data: state.rank_data,\n    clicked_circles: state.clicked_circles,\n    threshold: state.threshold,\n    histogram_data: state.histogram_data,\n    lime_data: state.lime_data,\n    \n\n  }\n}\nconst mapdispatchToprop = (dispatch) => {\n  return {\n    Set_selected_instances: (val) => dispatch({ type: \"selected_instances\", value: val }),\n    Set_clicked_circles: (val) => dispatch({ type: \"clicked_circles\", value: val }),\n    Set_time_mode_year1: (val) => dispatch({ type: \"time_mode_year1\", value: val }),\n    Set_time_mode_year2: (val) => dispatch({ type: \"time_mode_year2\", value: val }),\n    Set_deviation_array: (val) => dispatch({ type: \"deviation_array\", value: val }),\n  }\n}\nexport default connect(maptstateToprop, mapdispatchToprop)(SlopeChart);"]},"metadata":{},"sourceType":"module"}