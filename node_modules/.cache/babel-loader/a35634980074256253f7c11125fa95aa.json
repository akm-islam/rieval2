{"ast":null,"code":"import _toConsumableArray from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{connect}from\"react-redux\";import*as d3 from'd3';import exp_fiscal_CordAscent from\"../../../Data/data/fiscal/lime/chart1_data.csv\";import exp_school_CordAscent from\"../../../Data/data/school/lime/chart1_data.csv\";import exp_house_CordAscent from\"../../../Data/data/house/lime/chart1_data.csv\";import rur_histogram_data from\"../../../Data/RUR/RUR_histogram_data.csv\";import CreateHistogram from'./CreateHistogram';import CreateBarChart from'./CreateBarChart';import Button from'@material-ui/core/Button';var FeatureHistograms=/*#__PURE__*/function(_Component){_inherits(FeatureHistograms,_Component);var _super=_createSuper(FeatureHistograms);function FeatureHistograms(props){var _this;_classCallCheck(this,FeatureHistograms);_this=_super.call(this,props);_this.store_instances=function(feature_name,instances){var temp=_objectSpread({},_this.state.all_instances);temp[feature_name]=instances;_this.setState({all_instances:temp});};_this.state={feature_data:[]};return _this;}_createClass(FeatureHistograms,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var filename;if(this.props.dataset==\"fiscal\"){filename=exp_fiscal_CordAscent;}else if(this.props.dataset==\"school\"){filename=exp_school_CordAscent;}else if(this.props.dataset==\"house\"){filename=exp_house_CordAscent;}else if(this.props.dataset==\"rur\"){filename=rur_histogram_data;}d3.csv(filename).then(function(feature_data){_this2.setState({feature_data:feature_data,all_instances:{}});});}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps,nextState){if(typeof this.state.all_instances!=\"undefined\"&&JSON.stringify(nextState.all_instances)!==JSON.stringify(this.state.all_instances)){return false;}return true;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var _this3=this;var self=this;var filename;var selected_instances=d3.range(this.props.state_range[0],this.props.state_range[1]+1);//-------------------- Get the features and sort them\nvar number_of_charts=9;var filtered_rank_data=this.props.rank_data[this.props.default_models[0]].filter(function(element){if(parseInt(element['1-qid'])==parseInt(_this3.props.selected_year)){return element;}});var data=selected_instances.map(function(index){return filtered_rank_data[index];});var my_features_rank_col=Object.keys(data[0]).filter(function(item){return item.includes(\"_feature_rank\");});var sorted_features=my_features_rank_col.map(function(element){return element.replace(\"_feature_rank\",\"\");}).sort(function(a,b){return a.localeCompare(b);});console.log(sorted_features,\"dddd\");//--------------------\nif(this.props.dataset==\"fiscal\"){filename=exp_fiscal_CordAscent;}else if(this.props.dataset==\"school\"){filename=exp_school_CordAscent;}else if(this.props.dataset==\"rur\"){filename=rur_histogram_data;}//--------------------------------Iterate through each features\nd3.select(\".feature_histograms_container\").selectAll(\".feature\").data(sorted_features,function(d){return d;}).join(\"svg\").attr(\"class\",'feature').attr(\"add_histogram\",function(d,feature_index){var histogram_data=[];if(!isNaN(self.state.feature_data[0][d])){self.state.feature_data.forEach(function(element){if(element[\"1-qid\"]==self.props.selected_year){var temp_dict={};temp_dict[\"x\"]=parseInt(element['two_realRank']);temp_dict[\"y\"]=parseFloat(element[d]);histogram_data.push(temp_dict);}});CreateHistogram(histogram_data,d3.select(this),d,feature_index,sorted_features.length,self.store_instances);}else{self.state.feature_data.forEach(function(element){if(element[\"1-qid\"]==self.props.selected_year){var temp_dict={};temp_dict[\"x\"]=parseInt(element['two_realRank']);temp_dict[\"y\"]=element[d];histogram_data.push(temp_dict);}});CreateBarChart(histogram_data,d3.select(this),d,feature_index,sorted_features.length,self.store_instances,self.state.all_instances);}if(d==\"UAAL_pension_risk_free\"){console.log(d,self.state.feature_data,\"dddd\");}}).attr('id',function(d){return d;});//.call(d3.brush().extent([[0, margin.top], [400, 65]]))\n//--------------------------------Iterate through each features\n}},{key:\"render\",value:function render(){var _this4=this;return this.props.original_data!=null?/*#__PURE__*/React.createElement(\"div\",{style:{display:'relative',width:400,marginTop:-8}},/*#__PURE__*/React.createElement(Button,{fullWidth:true,style:{margin:0,position:'sticky',top:0,backgroundColor:\"gray\",borderRadius:0},onClick:function onClick(){var _ref;var selected_instances=_toConsumableArray(new Set((_ref=[]).concat.apply(_ref,_toConsumableArray(Object.values(_this4.state.all_instances)))));var filtered_instances=selected_instances.filter(function(item){return item>=_this4.props.state_range[0]&&item<=_this4.props.state_range[1];});_this4.props.handleClose();// This will close the select menu\nif(filtered_instances.length==0){alert(\"No instance is available withing the selected range!\");}_this4.props.Set_histogram_data(_toConsumableArray(filtered_instances));}},\" Update \"),/*#__PURE__*/React.createElement(\"div\",{className:\"feature_histograms_container_div\",style:{display:'relative',width:400,height:window.innerHeight,overflow:\"scroll\",marginTop:-8}},/*#__PURE__*/React.createElement(\"svg\",{className:\"feature_histograms_container\",style:{width:\"100%\",padding:10}},\" \"))):null;}}]);return FeatureHistograms;}(Component);var maptstateToprop=function maptstateToprop(state){return{dataset:state.dataset,deviate_by:state.deviate_by,state_range:state.state_range,default_models:state.default_models,selected_year:state.selected_year,sparkline_data:state.sparkline_data,show:state.show,mode:state.mode,original_data:state.original_data,rank_data:state.rank_data};};var mapdispatchToprop=function mapdispatchToprop(dispatch){return{Set_slider_max:function Set_slider_max(val){return dispatch({type:\"slider_max\",value:val});},Set_state_range:function Set_state_range(val){return dispatch({type:\"state_range\",value:val});},Set_histogram_data:function Set_histogram_data(val){return dispatch({type:\"histogram_data\",value:val});}};};export default connect(maptstateToprop,mapdispatchToprop)(FeatureHistograms);//https://material-ui.com/api/slider/\n//https://material-ui.com/components/expansion-panels/\n//https://material-ui.com/api/checkbox/\n//https://material-ui.com/components/radio-buttons/","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Top/FeatureHistograms/FeatureHistograms.js"],"names":["React","Component","connect","d3","exp_fiscal_CordAscent","exp_school_CordAscent","exp_house_CordAscent","rur_histogram_data","CreateHistogram","CreateBarChart","Button","FeatureHistograms","props","store_instances","feature_name","instances","temp","state","all_instances","setState","feature_data","filename","dataset","csv","then","nextProps","nextState","JSON","stringify","self","selected_instances","range","state_range","number_of_charts","filtered_rank_data","rank_data","default_models","filter","element","parseInt","selected_year","data","map","index","my_features_rank_col","Object","keys","item","includes","sorted_features","replace","sort","a","b","localeCompare","console","log","select","selectAll","d","join","attr","feature_index","histogram_data","isNaN","forEach","temp_dict","parseFloat","push","length","original_data","display","width","marginTop","margin","position","top","backgroundColor","borderRadius","Set","concat","values","filtered_instances","handleClose","alert","Set_histogram_data","height","window","innerHeight","overflow","padding","maptstateToprop","deviate_by","sparkline_data","show","mode","mapdispatchToprop","dispatch","Set_slider_max","val","type","value","Set_state_range"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport * as d3 from 'd3';\nimport exp_fiscal_CordAscent from \"../../../Data/data/fiscal/lime/chart1_data.csv\";\nimport exp_school_CordAscent from \"../../../Data/data/school/lime/chart1_data.csv\";\nimport exp_house_CordAscent from \"../../../Data/data/house/lime/chart1_data.csv\";\nimport rur_histogram_data from \"../../../Data/RUR/RUR_histogram_data.csv\";\nimport CreateHistogram from './CreateHistogram'\nimport CreateBarChart from './CreateBarChart';\nimport Button from '@material-ui/core/Button';\nclass FeatureHistograms extends Component {\n    constructor(props) {\n        super(props);\n        this.state = { feature_data: [] };\n    }\n    componentDidMount() {\n        var filename; if (this.props.dataset == \"fiscal\") { filename = exp_fiscal_CordAscent } else if (this.props.dataset == \"school\") { filename = exp_school_CordAscent } else if (this.props.dataset == \"house\") { filename = exp_house_CordAscent } else if (this.props.dataset == \"rur\") { filename = rur_histogram_data }\n        d3.csv(filename).then(feature_data => {\n            this.setState({ feature_data: feature_data,all_instances:{} })\n        })\n    }\n    store_instances=(feature_name,instances)=>{\n        var temp={...this.state.all_instances}\n        temp[feature_name]=instances\n        this.setState({all_instances:temp})\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n        if(typeof(this.state.all_instances)!=\"undefined\" && JSON.stringify(nextState.all_instances)!==JSON.stringify(this.state.all_instances)){\n            return false\n        }\n        return true    \n    }\n    componentDidUpdate() {\n        var self = this\n        var filename;\n        var selected_instances = d3.range(this.props.state_range[0], this.props.state_range[1] + 1)\n       \n        //-------------------- Get the features and sort them\n        var number_of_charts = 9\n        var filtered_rank_data = this.props.rank_data[this.props.default_models[0]].filter(element => { if (parseInt(element['1-qid']) == parseInt(this.props.selected_year)) { return element } })\n        var data = selected_instances.map(index => filtered_rank_data[index])\n        var my_features_rank_col=Object.keys(data[0]).filter(item=>item.includes(\"_feature_rank\"))\n        var sorted_features = my_features_rank_col.map((element) => element.replace(\"_feature_rank\", \"\")).sort((a, b) => a.localeCompare(b))\n        console.log(sorted_features,\"dddd\")\n        //--------------------\n\n\n        if (this.props.dataset == \"fiscal\") { filename = exp_fiscal_CordAscent } else if (this.props.dataset == \"school\") { filename = exp_school_CordAscent } else if (this.props.dataset == \"rur\") { filename = rur_histogram_data }\n        //--------------------------------Iterate through each features\n        \n        \n        d3.select(\".feature_histograms_container\").selectAll(\".feature\").data(sorted_features, d => d).join(\"svg\").attr(\"class\", 'feature')\n            .attr(\"add_histogram\", function (d, feature_index) {\n                var histogram_data = []\n                if (!isNaN(self.state.feature_data[0][d])) {\n                    self.state.feature_data.forEach(element => {\n                        if (element[\"1-qid\"] == self.props.selected_year) {\n                            var temp_dict = {}\n                            temp_dict[\"x\"] = parseInt(element['two_realRank'])\n                            temp_dict[\"y\"] = parseFloat(element[d])\n                            histogram_data.push(temp_dict)\n                        }\n                    });\n                    CreateHistogram(histogram_data, d3.select(this), d, feature_index, sorted_features.length,self.store_instances)\n                }\n                else {\n                    self.state.feature_data.forEach(element => {\n                        if (element[\"1-qid\"] == self.props.selected_year) {\n                            var temp_dict = {}\n                            temp_dict[\"x\"] = parseInt(element['two_realRank'])\n                            temp_dict[\"y\"] = element[d]\n                            histogram_data.push(temp_dict)\n                        }})\n                    CreateBarChart(histogram_data, d3.select(this), d, feature_index, sorted_features.length,self.store_instances,self.state.all_instances)\n                }\n                if(d==\"UAAL_pension_risk_free\"){\n                    console.log(d,self.state.feature_data,\"dddd\")\n                }\n            })\n            .attr('id',d=>d)\n            //.call(d3.brush().extent([[0, margin.top], [400, 65]]))\n        //--------------------------------Iterate through each features\n    }\n    render() {\n        return (\n            this.props.original_data != null ? <div style={{display:'relative', width: 400,marginTop:-8 }}>\n                <Button fullWidth style={{margin:0,position:'sticky',top:0,backgroundColor:\"gray\",borderRadius:0}} onClick={()=>{\n                    var selected_instances=[...new Set([].concat(...Object.values(this.state.all_instances)))]\n                    var filtered_instances=selected_instances.filter(item => item>=this.props.state_range[0] && item<=this.props.state_range[1])\n                    this.props.handleClose() // This will close the select menu\n                    if(filtered_instances.length==0){alert(\"No instance is available withing the selected range!\")}\n                    this.props.Set_histogram_data([...filtered_instances])\n                }}> Update </Button>\n                <div className=\"feature_histograms_container_div\" style={{display:'relative', width: 400, height: window.innerHeight, overflow: \"scroll\",marginTop:-8 }}>\n                <svg className=\"feature_histograms_container\" style={{ width: \"100%\", padding: 10 }}> </svg>\n                </div>\n            </div> : null\n        );\n    }\n}\nconst maptstateToprop = (state) => {\n    return {\n        dataset: state.dataset,\n        deviate_by: state.deviate_by,\n        state_range: state.state_range,\n        default_models: state.default_models,\n        selected_year: state.selected_year,\n        sparkline_data: state.sparkline_data,\n        show: state.show,\n        mode: state.mode,\n        original_data: state.original_data,\n        rank_data: state.rank_data,\n    }\n}\nconst mapdispatchToprop = (dispatch) => {\n    return {\n        Set_slider_max: (val) => dispatch({ type: \"slider_max\", value: val }),\n        Set_state_range: (val) => dispatch({ type: \"state_range\", value: val }),\n        Set_histogram_data: (val) => dispatch({ type: \"histogram_data\", value: val }),\n    }\n}\nexport default connect(maptstateToprop, mapdispatchToprop)(FeatureHistograms);\n\n//https://material-ui.com/api/slider/\n//https://material-ui.com/components/expansion-panels/\n//https://material-ui.com/api/checkbox/\n//https://material-ui.com/components/radio-buttons/"]},"metadata":{},"sourceType":"module"}