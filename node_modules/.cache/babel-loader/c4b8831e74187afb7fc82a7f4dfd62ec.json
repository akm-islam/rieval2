{"ast":null,"code":"import * as d3 from \"d3\";\nimport * as $ from \"jquery\";\nexport default function CreateHistogram(histogram_data, svg, feature_name, feature_index, number_of_features, store_instances) {\n  const margin = {\n    top: 10,\n    right: 5,\n    bottom: 50,\n    left: 5\n  };\n  var parent_width = $(\".feature_histograms_container\").width();\n  var feature_height = 120;\n  var feature_width = parent_width;\n  d3.select(\".feature_histograms_container\").attr('height', feature_height * number_of_features + 20);\n  svg.attr('y', feature_height * feature_index).attr('width', parent_width).attr('height', feature_height);\n  var item_data = histogram_data.map(item => item['y']);\n  var area_chart_height = feature_height - margin.top - margin.bottom;\n  var area_chart_width = feature_width - margin.left - margin.right;\n  const y = d3.scaleLinear().domain(d3.extent(item_data)).range([margin.top, area_chart_height]);\n  var myticks = y.ticks(25);\n  var binned_data = d3.histogram().value(d => d).domain(y.domain()).thresholds(myticks)(item_data); //--------- Create the areaChart\n\n  var area_chart_data = [];\n  binned_data.map((item, i) => area_chart_data.push([item.x1, item.length]));\n  console.log(feature_name, histogram_data);\n  var xScale = d3.scaleLinear().domain(d3.extent(area_chart_data.map(item => item[0]))).range([margin.left, feature_width - margin.right]); // 20 is the baseline\n\n  var yScale = d3.scaleLinear().domain([0, d3.max(area_chart_data.map(item => item[1]))]).range([area_chart_height, 0]);\n  const areaGenerator = d3.area().curve(d3.curveMonotoneX).x(d => xScale(d[0])).y0(yScale(0)).y1(d => yScale(d[1]));\n  svg.append(\"path\").attr('transform', 'translate(0,' + margin.top + ')').attr(\"d\", areaGenerator(area_chart_data)).style(\"fill\", \"gray\"); //--------------------------------\n\n  svg.selectAll(\".xAxis_g\").data([0]).join('g').attr('class', 'xAxis_g').attr(\"transform\", \"translate(0,\" + (feature_height - margin.bottom) + \")\").call(d3.axisBottom(xScale).ticks(5).tickFormat(d3.format(\".2s\"))); //.call(d3.axisBottom(xScale).ticks(5));\n\n  svg.selectAll('.domain').attr('stroke', '#dddddd');\n  svg.call(d3.brushX().extent([[0, margin.top], [400, area_chart_height + margin.top]]).on(\"end\", () => {\n    var extent = d3.event.selection;\n\n    if (extent != null) {\n      var lower = xScale.invert(extent[0]),\n          upper = xScale.invert(extent[1]);\n      var instances = histogram_data.filter(item => item['y'] >= lower && item['y'] <= upper).map(item => item['x']); // x contains the ranking and y contains the value\n\n      store_instances(feature_name, instances);\n    } else {\n      store_instances(feature_name, []);\n    }\n  }));\n  svg.selectAll(\".title\").data([0]).join('text').attr(\"class\", \"title\").attr('x', feature_width / 2).attr('y', feature_height - 28).attr('dominant-baseline', 'hanging').attr('text-anchor', 'middle').text(feature_name).attr('font-size', 14).style('text-transform', 'capitalize').attr(\"fill\", \"#3d3b3b\");\n} //https://stackoverflow.com/questions/54236051/how-to-draw-a-vertical-area-chart","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Top/FeatureHistograms/CreateHistogram.js"],"names":["d3","$","CreateHistogram","histogram_data","svg","feature_name","feature_index","number_of_features","store_instances","margin","top","right","bottom","left","parent_width","width","feature_height","feature_width","select","attr","item_data","map","item","area_chart_height","area_chart_width","y","scaleLinear","domain","extent","range","myticks","ticks","binned_data","histogram","value","d","thresholds","area_chart_data","i","push","x1","length","console","log","xScale","yScale","max","areaGenerator","area","curve","curveMonotoneX","x","y0","y1","append","style","selectAll","data","join","call","axisBottom","tickFormat","format","brushX","on","event","selection","lower","invert","upper","instances","filter","text"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\"\nimport * as $ from \"jquery\"\nexport default function CreateHistogram(histogram_data, svg, feature_name, feature_index, number_of_features, store_instances) {\n  const margin = { top: 10, right: 5, bottom: 50, left: 5 };\n  var parent_width = $(\".feature_histograms_container\").width()\n  var feature_height = 120\n  var feature_width = parent_width\n  d3.select(\".feature_histograms_container\").attr('height', feature_height * number_of_features + 20)\n  svg.attr('y', feature_height * feature_index).attr('width', parent_width).attr('height', feature_height)\n  var item_data = histogram_data.map(item => item['y'])\n  var area_chart_height = feature_height - margin.top - margin.bottom;\n  var area_chart_width = feature_width - margin.left - margin.right\n  const y = d3.scaleLinear().domain(d3.extent(item_data)).range([margin.top, area_chart_height])\n\n  var myticks = y.ticks(25)\n  var binned_data = d3.histogram().value(d => d).domain(y.domain()).thresholds(myticks)(item_data)\n  //--------- Create the areaChart\n  var area_chart_data = []\n  binned_data.map((item, i) => area_chart_data.push([item.x1, item.length]))\n  console.log(feature_name,histogram_data)\n  var xScale = d3.scaleLinear().domain(d3.extent(area_chart_data.map(item => item[0]))).range([margin.left, feature_width - margin.right]) // 20 is the baseline\n  var yScale = d3.scaleLinear().domain([0, d3.max(area_chart_data.map(item => item[1]))]).range([area_chart_height, 0])\n  const areaGenerator = d3.area().curve(d3.curveMonotoneX).x(d => xScale(d[0])).y0(yScale(0)).y1(d => yScale(d[1]))\n\n  svg.append(\"path\").attr('transform', 'translate(0,' + margin.top + ')')\n    .attr(\"d\", areaGenerator(area_chart_data))\n    .style(\"fill\", \"gray\");\n//--------------------------------\n  svg.selectAll(\".xAxis_g\").data([0]).join('g').attr('class', 'xAxis_g').attr(\"transform\", \"translate(0,\" + (feature_height - margin.bottom) + \")\")\n    .call(d3.axisBottom(xScale).ticks(5).tickFormat(d3.format(\".2s\")));\n  //.call(d3.axisBottom(xScale).ticks(5));\n  svg.selectAll('.domain').attr('stroke', '#dddddd')\n  svg.call(d3.brushX().extent([[0, margin.top], [400, area_chart_height + margin.top]]).on(\"end\", () => {\n    var extent = d3.event.selection\n    if (extent != null) {\n      var lower = xScale.invert(extent[0]), upper = xScale.invert(extent[1])\n      var instances = histogram_data.filter(item => item['y'] >= lower && item['y'] <= upper).map(item => item['x']) // x contains the ranking and y contains the value\n      store_instances(feature_name, instances)\n    }\n    else{store_instances(feature_name, [])}\n  }))\n  svg.selectAll(\".title\").data([0]).join('text').attr(\"class\",\"title\").attr('x', feature_width / 2).attr('y', feature_height - 28).attr('dominant-baseline', 'hanging')\n  .attr('text-anchor', 'middle').text(feature_name).attr('font-size', 14).style('text-transform', 'capitalize')\n  .attr(\"fill\",\"#3d3b3b\")\n}\n//https://stackoverflow.com/questions/54236051/how-to-draw-a-vertical-area-chart"]},"metadata":{},"sourceType":"module"}