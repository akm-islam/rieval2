{"ast":null,"code":"var _jsxFileName = \"/Users/kaustav/NewWork/trivea/src/components/Legend/Legend.js\";\nimport React, { Component, PureComponent } from 'react';\nimport * as d3 from 'd3';\nimport * as $ from 'jquery';\nimport { connect } from \"react-redux\";\nimport Grid from '@mui/material/Grid';\nimport './legend.scss';\n\nclass Legend extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {}; // This is the default height\n  }\n\n  componentDidMount() {\n    this.setState({\n      rand: 10\n    });\n  }\n\n  componentDidUpdate() {\n    var legend_container_width = $('.legend_container').width();\n    var legend_container_height = $('.legend_container').height(); //--------------------------- Legend 1\n\n    var legend1_height = 100;\n    var legend1_rScale = d3.scaleLinear().domain(d3.extent(this.props.deviation_array)).range([this.props.global_config.max_circle_r, this.props.global_config.min_circle_r]);\n    var legend1_yScale = d3.scaleLinear().domain(d3.extent(this.props.deviation_array)).range([this.props.global_config.max_circle_r, legend1_height - 5]);\n\n    if (this.props.deviation_array.length > 3) {\n      var legend1_ticks = [d3.min(this.props.deviation_array), Math.ceil(d3.max(this.props.deviation_array) * .33), Math.ceil(d3.max(this.props.deviation_array) * .66), d3.max(this.props.deviation_array)];\n    } else {\n      var legend1_ticks = this.props.deviation_array;\n    }\n\n    legend1_ticks = legend1_ticks.filter(item => item % 1 === 0); //console.log(legend1_ticks,\"legend1_ticks\")\n\n    var legend1_svg = d3.select('#legend1').attr('width', legend_container_width).attr('height', legend1_height);\n    legend1_svg.selectAll('.legend1_circles').data(legend1_ticks).join('circle').attr('class', 'legend1_circles').attr('cx', 10).attr('cy', d => legend1_yScale(d)).attr('r', d => legend1_rScale(d)).attr('fill', 'grey');\n    legend1_svg.selectAll('.legend1_text').data(legend1_ticks).join('text').attr('class', 'legend1_text').attr('x', 23).attr('y', d => legend1_yScale(d)).attr('dominant-baseline', 'middle').attr('font-size', 10).text(d => {\n      if (d == d3.min(legend1_ticks)) {\n        return d + \" (Most Precise)\";\n      }\n\n      if (d == d3.max(legend1_ticks)) {\n        return d + \" (Least Precise)\";\n      }\n\n      return d;\n    }); //--------------------------- Legend 2\n\n    var min = d3.min(this.props.selected_instances),\n        max = d3.max(this.props.selected_instances);\n    var d = (max - min) / 8; //var diverginColor = d3.scaleLinear().domain([min + d * 7, min + d * 6, min + d * 5, min + d * 4, min + d * 3, min + d * 2, min]).interpolate(d3.interpolateRgb).range(['#af8dc3','#b197c1','#dbd88c','#dbd88c', '#dbd88c', '#90bc8d', '#7fbf7b']);\n    //var diverginColor = d3.scaleDiverging([min,(max - min) / 2 , max], d3.interpolateSpectral)\n    //var diverginColor = d3.scaleDiverging([max, parseInt((max+min)/2), min], d3.interpolateRgbBasis(['#af8dc3', '#dbd88c', '#7fbf7b']));\n\n    var diverginColor = d3.scaleDiverging([max, parseInt((max + min) / 2), min], d3.interpolateRgbBasis(['#b37cd3', '#d9d58c', '#71ce6c'])); //50% saturation\n\n    var legend2_svg_height = legend_container_height / 2 - 50;\n    var legend2_yScale = d3.scaleLinear().domain([min, max]).range([5, legend2_svg_height - 10]);\n    var legend2_ticks = d3.range(min, max + 1, max / 10);\n    var rect_height = legend2_svg_height / legend2_ticks.length;\n    var rect_width = 12;\n    var legend2_svg = d3.select('#legend2').attr('width', legend_container_width).attr('height', legend2_svg_height);\n    legend2_svg.selectAll('.legend2_rects').data(legend2_ticks).join('rect').attr('class', 'legend2_rects').attr('x', 10).attr('y', (d, i) => rect_height * i).attr('width', rect_width).attr('height', rect_height).attr('fill', d => diverginColor(d));\n    legend2_svg.selectAll(\".legend2_labels\").data([min, parseInt(max / 2), max]).join(\"text\").attr(\"x\", 10 + rect_width + 2).attr(\"class\", \"legend2_labels\").attr('dominant-baseline', \"middle\").attr('y', (d, i) => i == 0 ? legend2_yScale(d) + rect_height / 2 : legend2_yScale(d)).text(d => d).attr('font-size', 12);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Grid, {\n      className: \"legend_container\",\n      container: true,\n      direction: \"column\",\n      justifyContent: \"center\",\n      alignItems: \"flex-start\",\n      style: {\n        width: \"100%\",\n        height: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      style: {\n        width: this.props.legend_width\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      item: true,\n      style: {\n        backgroundColor: 'rgb(211, 211, 211,0.5)',\n        padding: 5,\n        marginBottom: 5\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"title\",\n      style: {\n        marginBottom: 10\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 13\n      }\n    }, \" Rank Deviation\"), /*#__PURE__*/React.createElement(\"svg\", {\n      id: \"legend1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }\n    }, \" \"))), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      container: true,\n      direction: \"column\",\n      alignItems: \"center\",\n      style: {\n        width: this.props.legend_width,\n        backgroundColor: 'rgb(211, 211, 211,0.5)',\n        padding: 5\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"title\",\n      style: {\n        marginBottom: 10\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }\n    }, \" Rank Range\"), /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        margin: 0,\n        fontSize: 12,\n        display: \"block\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }\n    }, \"High\"), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      id: \"legend2\",\n      style: {\n        marginTop: 3,\n        marginBottom: 0\n      },\n      transform: \"translate(40,0)\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 24\n      }\n    })), /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        margin: 0,\n        fontSize: 12\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 13\n      }\n    }, \"Low\")));\n  }\n\n}\n\nconst maptstateToprop = state => {\n  return {\n    selected_instances: state.selected_instances,\n    deviation_array: state.deviation_array,\n    global_config: state.global_config\n  };\n};\n\nconst mapdispatchToprop = dispatch => {\n  return {\n    Set_legend_year: val => dispatch({\n      type: \"legend_year\",\n      value: val\n    })\n  };\n};\n\nexport default connect(maptstateToprop, mapdispatchToprop)(Legend);","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Legend/Legend.js"],"names":["React","Component","PureComponent","d3","$","connect","Grid","Legend","constructor","props","state","componentDidMount","setState","rand","componentDidUpdate","legend_container_width","width","legend_container_height","height","legend1_height","legend1_rScale","scaleLinear","domain","extent","deviation_array","range","global_config","max_circle_r","min_circle_r","legend1_yScale","length","legend1_ticks","min","Math","ceil","max","filter","item","legend1_svg","select","attr","selectAll","data","join","d","text","selected_instances","diverginColor","scaleDiverging","parseInt","interpolateRgbBasis","legend2_svg_height","legend2_yScale","legend2_ticks","rect_height","rect_width","legend2_svg","i","render","legend_width","backgroundColor","padding","marginBottom","margin","fontSize","display","marginTop","maptstateToprop","mapdispatchToprop","dispatch","Set_legend_year","val","type","value"],"mappings":"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","sourcesContent":["import React, { Component, PureComponent } from 'react';\nimport * as d3 from 'd3';\nimport * as $ from 'jquery';\nimport { connect } from \"react-redux\";\nimport Grid from '@mui/material/Grid';\nimport './legend.scss'\nclass Legend extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {} // This is the default height\n  }\n  componentDidMount() { this.setState({ rand: 10 }) }\n  componentDidUpdate() {\n    var legend_container_width = $('.legend_container').width()\n    var legend_container_height = $('.legend_container').height()\n    //--------------------------- Legend 1\n    var legend1_height = 100\n    var legend1_rScale = d3.scaleLinear().domain(d3.extent(this.props.deviation_array)).range([this.props.global_config.max_circle_r, this.props.global_config.min_circle_r])\n    var legend1_yScale = d3.scaleLinear().domain(d3.extent(this.props.deviation_array)).range([this.props.global_config.max_circle_r, legend1_height - 5])\n    if(this.props.deviation_array.length>3){\n      var legend1_ticks = [d3.min(this.props.deviation_array),Math.ceil(d3.max(this.props.deviation_array)*.33),Math.ceil(d3.max(this.props.deviation_array)*.66),d3.max(this.props.deviation_array)]\n    }\n    else{\n      var legend1_ticks = this.props.deviation_array\n    }\n    \n    legend1_ticks=legend1_ticks.filter(item=>item % 1 === 0)\n    //console.log(legend1_ticks,\"legend1_ticks\")\n    var legend1_svg = d3.select('#legend1').attr('width', legend_container_width).attr('height', legend1_height)\n    legend1_svg.selectAll('.legend1_circles').data(legend1_ticks).join('circle').attr('class', 'legend1_circles').attr('cx', 10).attr('cy', d => legend1_yScale(d)).attr('r', d => legend1_rScale(d)).attr('fill', 'grey')\n    legend1_svg.selectAll('.legend1_text').data(legend1_ticks).join('text').attr('class', 'legend1_text').attr('x', 23).attr('y', d => legend1_yScale(d)).attr('dominant-baseline', 'middle').attr('font-size', 10)\n    .text(d =>{\n      if(d==d3.min(legend1_ticks)){return d+\" (Most Precise)\" }\n      if(d==d3.max(legend1_ticks)){return d+\" (Least Precise)\" }\n      return d\n    })\n    //--------------------------- Legend 2\n    var min = d3.min(this.props.selected_instances), max = d3.max(this.props.selected_instances);\n    var d = (max - min) / 8;\n    //var diverginColor = d3.scaleLinear().domain([min + d * 7, min + d * 6, min + d * 5, min + d * 4, min + d * 3, min + d * 2, min]).interpolate(d3.interpolateRgb).range(['#af8dc3','#b197c1','#dbd88c','#dbd88c', '#dbd88c', '#90bc8d', '#7fbf7b']);\n    //var diverginColor = d3.scaleDiverging([min,(max - min) / 2 , max], d3.interpolateSpectral)\n    //var diverginColor = d3.scaleDiverging([max, parseInt((max+min)/2), min], d3.interpolateRgbBasis(['#af8dc3', '#dbd88c', '#7fbf7b']));\n    var diverginColor = d3.scaleDiverging([max, parseInt((max+min)/2), min], d3.interpolateRgbBasis(['#b37cd3', '#d9d58c', '#71ce6c'])); //50% saturation\n    var legend2_svg_height = legend_container_height / 2 - 50\n\n    var legend2_yScale = d3.scaleLinear().domain([min, max]).range([5, legend2_svg_height - 10])\n    var legend2_ticks = d3.range(min, max + 1, max / 10)\n    var rect_height = legend2_svg_height / legend2_ticks.length\n    var rect_width = 12\n    \n    var legend2_svg = d3.select('#legend2').attr('width', legend_container_width).attr('height', legend2_svg_height)\n    legend2_svg.selectAll('.legend2_rects').data(legend2_ticks).join('rect').attr('class', 'legend2_rects').attr('x', 10)\n    .attr('y', (d, i) => rect_height*i).attr('width', rect_width).attr('height', rect_height).attr('fill', d => diverginColor(d))\n    legend2_svg.selectAll(\".legend2_labels\").data([min, parseInt(max / 2), max]).join(\"text\").attr(\"x\", 10 + rect_width + 2).attr(\"class\", \"legend2_labels\").attr('dominant-baseline', \"middle\").attr('y', (d, i) => i == 0 ? legend2_yScale(d) + rect_height / 2 : legend2_yScale(d)).text(d => d).attr('font-size', 12)\n  }\n\n  render() {\n    return (\n      <Grid className=\"legend_container\" container direction=\"column\" justifyContent=\"center\" alignItems=\"flex-start\" style={{ width: \"100%\", height: \"100%\" }}>\n        <Grid item style={{width:this.props.legend_width}}>\n          <div item style={{ backgroundColor: 'rgb(211, 211, 211,0.5)', padding: 5, marginBottom: 5 }}>\n            <p className=\"title\" style={{ marginBottom: 10 }}> Rank Deviation</p>\n            <svg id=\"legend1\"> </svg>\n          </div>\n        </Grid>\n        <Grid item container direction=\"column\" alignItems=\"center\" style={{width:this.props.legend_width,backgroundColor: 'rgb(211, 211, 211,0.5)', padding: 5 }}>\n            <p className=\"title\" style={{ marginBottom: 10 }}> Rank Range</p>\n            <p style={{ margin:0,fontSize:12,display:\"block\" }}>High</p>\n            <Grid item><svg id=\"legend2\" style={{marginTop:3,marginBottom:0}} transform=\"translate(40,0)\"></svg></Grid>\n            <p style={{ margin:0,fontSize:12 }}>Low</p>\n        </Grid>\n      </Grid>\n    );\n  }\n}\nconst maptstateToprop = (state) => {\n  return {\n    selected_instances: state.selected_instances,\n    deviation_array: state.deviation_array,\n    global_config:state.global_config\n  }\n}\nconst mapdispatchToprop = (dispatch) => {\n  return {\n    Set_legend_year: (val) => dispatch({ type: \"legend_year\", value: val }),\n  }\n}\nexport default connect(maptstateToprop, mapdispatchToprop)(Legend);"]},"metadata":{},"sourceType":"module"}