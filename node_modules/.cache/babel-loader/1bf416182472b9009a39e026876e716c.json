{"ast":null,"code":"import _toConsumableArray from\"/Users/kaustav/NewWork/trivea/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import*as d3 from'd3';var CreateCatChart=function CreateCatChart(data,feature,scatterplot_data,props){var rScale=d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6,1]);var feature_contribute=feature+\"_contribution\";var margin={top:0,right:30,bottom:85,left:50,space_for_hist:0},feature_width=520-margin.left-margin.right,height=270-margin.top-margin.bottom;var barplot_data={};data=data.filter(function(d){return parseFloat(d[feature_contribute])>0;});data.map(function(item){if(barplot_data[item[feature]]>0){barplot_data[item[feature]]+=1;}else{barplot_data[item[feature]]=1;}});var temp_y=Object.keys(barplot_data),temp_x=Object.values(barplot_data),x=d3.scaleLinear().domain([d3.min(temp_x),d3.max(temp_x)]).range([0,feature_width]).nice();// circles will start from y position 10 and go upto height-10\nvar y=d3.scaleBand().domain(temp_y).range([0,height]).padding(0.1);// add the x Axis\n//------------------------------------------------------------- All svgs\nvar parent_svg=d3.select(\"#\"+props.myid).attr(\"width\",feature_width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom+margin.space_for_hist),svg1=parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\",margin.space_for_hist).attr(\"class\",\"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\",\"myg\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var svg1=parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\",\"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\",\"myg\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");//------------- Add Y axis\nsvg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\",\"myYaxis\").attr(\"transform\",\"translate(\"+(feature_width+20)+\",20)\").call(d3.axisLeft(y).tickSize(feature_width)).selectAll(\"text\").selectAll(\".tick line\").remove();svg1.selectAll(\".domain\").remove();svg1.selectAll(\".tick line\").attr(\"stroke\",\"#EBEBEB\");//------------------------------------------------------------------------------------------------------ Scatterplot starts here\nsvg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\",function(d){return d[0]+\"scatterplot_g_id\";}).attr(\"class\",\"scatterplot_g\").attr(\"ax\",function(d){var temp_x=d[1].map(function(item){return parseFloat(item[feature+\"_contribution\"]);});// d[1] \nx=d3.scaleLinear().domain([d3.min(temp_x),d3.max(temp_x)]).range([0,feature_width]).nice();var circle_data=d[1].sort(function(a,b){return a['deviation']-b['deviation'];});d3.select(this).selectAll('circle').data(circle_data).join(\"circle\").attr(\"cy\",function(d,i){return y(d[feature])+35;}).attr(\"cx\",function(d,i){return x(parseFloat(d[feature_contribute]));}).attr(\"r\",function(d){return parseFloat(d[feature_contribute])<=0?0:rScale(d['deviation']);}).attr(\"fill\",function(d){return props.diverginColor(d['two_realRank']).replace(\")\",\",.7)\");}).attr('class',function(d){return'my_circles';}).attr(\"id\",function(d){return d['id'];}).on('click',function(d){props.Set_clicked_circles(props.clicked_circles.includes(d['id'])?props.clicked_circles.filter(function(item){return item!=d['id'];}):[].concat(_toConsumableArray(props.clicked_circles),[d['id']]));});});//---------------------------------------------Feature Importance with Arrow\nvar ft_svg_height=25;parent_svg.selectAll(\".ft_svg\").remove();var ft_svg=parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\",70).attr(\"y\",height+10).attr(\"class\",\"ft_svg\").attr(\"width\",feature_width).attr(\"height\",ft_svg_height);var markerBoxWidth=8,markerBoxHeight=8,refX=markerBoxWidth/2,refY=markerBoxHeight/2;ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id','arrow').attr('viewBox',[0,0,markerBoxWidth,markerBoxHeight]).attr('refX',refX).attr('refY',refY).attr('markerWidth',markerBoxWidth).attr('markerHeight',markerBoxHeight).attr('orient','auto-start-reverse').append('path').attr('id','path1').attr('d',d3.line()([[0,0],[0,7],[7,3.8]])).attr('stroke','#777777').attr(\"fill\",\"#777777\");//------------------------------------------------[[x2, y2], [x1, y1]]\nft_svg.append('path').attr('d',d3.line()([[feature_width/2-65,15],[50,15]])).attr('stroke','#777777').attr('marker-end','url(#arrow)').attr('fill','none');ft_svg.append('path').attr('d',d3.line()([[feature_width-50,15],[65+feature_width/2,15]])).attr('stroke','#777777').attr('marker-start','url(#arrow)').attr('fill','none');ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\",30).attr(\"class\",\"myText_low\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('Low').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\",feature_width/2).attr(\"class\",\"myText\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('Attribute Importance').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\",feature_width-30).attr(\"class\",\"myText_high\").attr('dominant-baseline',\"middle\").attr(\"y\",15).text('High').attr('text-anchor','middle').attr(\"font-size\",12).attr(\"fill\",\"#2b2828\");//---------------------------------------------Feature Importance with Arrow\n// Define the div for the tooltip\nvar div=d3.select(\"body\").append(\"div\").attr(\"class\",\"tooltip2\").style(\"opacity\",0);d3.selectAll('.exp_circles').on(\"mouseover\",function(d){div.transition().duration(200).style(\"opacity\",.9);div.html(\"<p>\"+d['State']+\"</p>\"+\"<p>\"+\"Model: \"+d3.select(this).attr('dataset_name')+\"</p>\")//div.html(d['State'])\n.style(\"left\",d3.event.pageX+\"px\").style(\"top\",d3.event.pageY-28+\"px\");}).on(\"mouseout\",function(d){d3.selectAll('.tooltip2').transition().duration(500).style(\"opacity\",0);});//------------------------------------------------------------------------------------------------------ Scatterplot ends here\n};export default CreateCatChart;","map":{"version":3,"sources":["/Users/kaustav/NewWork/trivea/src/components/Charts/Popover/CreateCatChart.js"],"names":["d3","CreateCatChart","data","feature","scatterplot_data","props","rScale","scalePow","exponent","domain","extent","deviation_array","range","feature_contribute","margin","top","right","bottom","left","space_for_hist","feature_width","height","barplot_data","filter","d","parseFloat","map","item","temp_y","Object","keys","temp_x","values","x","scaleLinear","min","max","nice","y","scaleBand","padding","parent_svg","select","myid","attr","svg1","selectAll","join","call","axisLeft","tickSize","remove","circle_data","sort","a","b","i","diverginColor","replace","on","Set_clicked_circles","clicked_circles","includes","ft_svg_height","ft_svg","Math","random","markerBoxWidth","markerBoxHeight","refX","refY","append","line","text","div","style","transition","duration","html","event","pageX","pageY"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\nvar CreateCatChart = (data, feature, scatterplot_data,props) => {\n    var rScale = d3.scalePow().exponent(0.4).domain(d3.extent(props.deviation_array)).range([6, 1])\n    var feature_contribute = feature + \"_contribution\"\n    var margin = { top: 0, right: 30, bottom: 85, left: 50, space_for_hist: 0 }, feature_width = 520 - margin.left - margin.right, height = 270 - margin.top - margin.bottom;\n    var barplot_data = {}\n    data = data.filter(d => parseFloat(d[feature_contribute]) > 0)\n    data.map(item => { if (barplot_data[item[feature]] > 0) { barplot_data[item[feature]] += 1 } else { barplot_data[item[feature]] = 1 } })\n\n    var temp_y = Object.keys(barplot_data),\n        temp_x = Object.values(barplot_data),\n        x = d3.scaleLinear().domain([d3.min(temp_x), d3.max(temp_x)]).range([0, feature_width]).nice(); // circles will start from y position 10 and go upto height-10\n\n    var y = d3.scaleBand().domain(temp_y).range([0, height]).padding(0.1);\n\n    // add the x Axis\n    //------------------------------------------------------------- All svgs\n    var parent_svg = d3.select(\"#\" + props.myid).attr(\"width\", feature_width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom + margin.space_for_hist),\n        svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"y\", margin.space_for_hist).attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\",\"translate(\" + margin.left + \",\" + margin.top + \")\")\n    var svg1 = parent_svg.selectAll('.svg11').data([0]).join('svg').attr(\"class\", \"svg11\").selectAll(\".myg\").data([0]).join('g').attr(\"class\", \"myg\").attr(\"transform\",\"translate(\" + margin.left + \",\" + margin.top + \")\")   \n    //------------- Add Y axis\n    svg1.selectAll(\".myYaxis\").data([0]).join('g').attr(\"class\", \"myYaxis\").attr(\"transform\", \"translate(\"+(feature_width+20)+\",20)\").call(d3.axisLeft(y).tickSize(feature_width)).selectAll(\"text\").selectAll(\".tick line\").remove()        \n    svg1.selectAll(\".domain\").remove()\n    svg1.selectAll(\".tick line\").attr(\"stroke\", \"#EBEBEB\")\n    //------------------------------------------------------------------------------------------------------ Scatterplot starts here\n    svg1.selectAll(\".scatterplot_g\").data(scatterplot_data).join('g').attr(\"id\", d => d[0] + \"scatterplot_g_id\").attr(\"class\", \"scatterplot_g\").attr(\"ax\", function (d) {\n        var temp_x = d[1].map(item => parseFloat(item[feature + \"_contribution\"])) // d[1] \n        x = d3.scaleLinear().domain([d3.min(temp_x), d3.max(temp_x)]).range([0, feature_width]).nice();\n        var circle_data=d[1].sort((a,b)=>a['deviation']-b['deviation'])\n        d3.select(this).selectAll('circle').data(circle_data)\n            .join(\"circle\")\n            .attr(\"cy\", (d, i) => {\n                return y(d[feature])+35\n            })\n            .attr(\"cx\", (d, i) => {\n                return x(parseFloat(d[feature_contribute]))\n\n            })\n            \n            .attr(\"r\", d => parseFloat(d[feature_contribute]) <= 0 ? 0 : rScale(d['deviation']))\n            .attr(\"fill\", (d) => {\n                return props.diverginColor(d['two_realRank']).replace(\")\",\",.7)\")\n            })\n\n            .attr('class', d => 'my_circles')\n            .attr(\"id\", d => d['id'])\n            .on('click', d => {\n                props.Set_clicked_circles(props.clicked_circles.includes(d['id']) ? props.clicked_circles.filter(item => item != d['id']) : [...props.clicked_circles, d['id']])\n            })\n    })\n  //---------------------------------------------Feature Importance with Arrow\n  var ft_svg_height = 25\n  parent_svg.selectAll(\".ft_svg\").remove()\n  var ft_svg = parent_svg.selectAll(\".ft_svg\").data([Math.random()]).join(\"svg\").attr(\"x\", 70).attr(\"y\", height+10).attr(\"class\", \"ft_svg\").attr(\"width\", feature_width).attr(\"height\", ft_svg_height)\n  var markerBoxWidth = 8, markerBoxHeight = 8, refX = markerBoxWidth / 2, refY = markerBoxHeight / 2\n  \n  ft_svg.selectAll('defs').data([0]).join('defs').selectAll('#arrow').data([0]).join('marker').attr('id', 'arrow').attr('viewBox', [0, 0, markerBoxWidth, markerBoxHeight])\n    .attr('refX', refX).attr('refY', refY).attr('markerWidth', markerBoxWidth).attr('markerHeight', markerBoxHeight).attr('orient', 'auto-start-reverse')\n    .append('path').attr('id','path1').attr('d', d3.line()([[0, 0], [0, 7], [7, 3.8]])).attr('stroke', '#777777').attr(\"fill\",\"#777777\");\n  //------------------------------------------------[[x2, y2], [x1, y1]]\n  ft_svg.append('path').attr('d', d3.line()([[feature_width / 2 - 65, 15], [50, 15]])).attr('stroke', '#777777').attr('marker-end', 'url(#arrow)').attr('fill', 'none');\n  ft_svg.append('path').attr('d', d3.line()([[feature_width - 50, 15], [65 + feature_width / 2, 15]])).attr('stroke', '#777777').attr('marker-start', 'url(#arrow)').attr('fill', 'none');\n\n  ft_svg.selectAll(\".myText_low\").data([0]).join(\"text\").attr(\"x\", 30).attr(\"class\", \"myText_low\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Low').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText\").data([0]).join(\"text\").attr(\"x\", feature_width / 2).attr(\"class\", \"myText\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('Attribute Importance').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  ft_svg.selectAll(\".myText_high\").data([0]).join(\"text\").attr(\"x\", feature_width-30).attr(\"class\", \"myText_high\").attr('dominant-baseline', \"middle\").attr(\"y\", 15).text('High').attr('text-anchor', 'middle').attr(\"font-size\", 12).attr(\"fill\", \"#2b2828\")\n  //---------------------------------------------Feature Importance with Arrow\n\n\n\n    // Define the div for the tooltip\n    var div = d3.select(\"body\").append(\"div\")\n        .attr(\"class\", \"tooltip2\")\n        .style(\"opacity\", 0);\n    d3.selectAll('.exp_circles')\n        .on(\"mouseover\", function (d) {\n            div.transition()\n                .duration(200)\n                .style(\"opacity\", .9);\n            div.html(\"<p>\" + d['State'] + \"</p>\" + \"<p>\" + \"Model: \" + d3.select(this).attr('dataset_name') + \"</p>\")\n                //div.html(d['State'])\n                .style(\"left\", (d3.event.pageX) + \"px\")\n                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        })\n        .on(\"mouseout\", function (d) {\n            d3.selectAll('.tooltip2').transition()\n                .duration(500)\n                .style(\"opacity\", 0);\n        })\n\n    //------------------------------------------------------------------------------------------------------ Scatterplot ends here\n}\nexport default CreateCatChart"]},"metadata":{},"sourceType":"module"}